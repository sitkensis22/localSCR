<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mark-resight models: continuous state-space with both marked and unmarked individuals • localSCR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mark-resight models: continuous state-space with both marked and unmarked individuals">
<meta property="og:description" content="Learn how to simulate and analyze basic mark-resight data in a SCR framework
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">localSCR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/classic_scr.html">Classic SCR models: continuous state-space and marked individuals</a>
    </li>
    <li>
      <a href="../articles/mark_resight_scr.html">Mark-resight models: continuous state-space with both marked and unmarked individuals</a>
    </li>
    <li>
      <a href="../articles/unmarked_scr.html">Spatial count models: continuous state-space and unmarked individuals</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mark_resight_scr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mark-resight models: continuous state-space with both marked and unmarked individuals</h1>
                        <h4 data-toc-skip class="author">Daniel Eacker</h4>
            
            <h4 data-toc-skip class="date">2022-04-27</h4>
      
      
      <div class="hidden name"><code>mark_resight_scr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>
The third vignette of the ‘localSCR’ package builds on ‘classic’ Bayesian spatial capture-recapture (SCR) models to introduce the spatial mark-resight model (Royle et al. 2014). The data consist of some counts of ‘unmarked’ individuals where individual identity is not possible along with ‘marked’ individuals that can be individually identified. We’ll present the case where there are an unknown number of ‘marked’ individuals, but there is a slightly different approach when there are a known number of marked individuals (e.g., collared animals picked up on camera; see Royle et al. 2014). In this mark-resight model, the marked and unmarked encounter model likelihoods share encounter rate and scaling parameters, where the marked data provide the majority of the information. In our analysis here, these models assume a uniform distribution of activity centers (i.e,. a continuous state-space). Although many distance detection functions are possible, the package currently includes only a bivariate normal model of space use, which is commonly employed in the literature. The package is meant to ease implementation of Bayesian SCR models using the ‘nimble’ package (de Valpine et a. 2022), which allows for increased flexibilty with the ability for the user to include custom functions and assign different algorithms to specific model parameters. I took advantage of this functionality with the goal of building a simple, straightforward workflow that was flexible enough to handle most mainstream SCR analysis problems. Visit <a href="https://r-nimble.org/download" class="external-link uri">https://r-nimble.org/download</a> for information on installing ‘nimble’ and Rtools on your computer.
</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h2>
<p>
</p>
<p>The ‘localSCR’ package implements Bayesian spatial count models using the ‘nimble’ package (de Valpine et a. 2022) following methods described in Royle et al. (2014). We take advantage of recent developments in computation of SCR models. In this tutorial, three methods are implemented to decrease computational run time:</p>
<ol style="list-style-type: decimal">
<li>Block updating of x and y activity center coordinates (Turek et al. 2021)</li>
<li>Using vectorized declarations for traps in distance function calculations</li>
<li>Separating the data augmentation process into two steps for marked indivdiuals (Chandler 2018)</li>
</ol>
<p>In some SCR problems, there are landscape features that create ‘unsuitable’ habitat for the study species. Habitat masks are used to account for these features and designate suitable (1) or unsuitable (0) habitat, and can be represented as a matrix or array of binary values. We follow the methods of Milleret et al. (2019) to implement the “ones” trick to account for habitat suitability. This restricts the possible locations of latent activity centers to only suitable habitat. The ‘localSCR’ package provides functions to construct a habitat mask from either raster or polygon data.</p>

<br><p>
</p>
</div>
<div class="section level2">
<h2 id="turtorial">Turtorial<a class="anchor" aria-label="anchor" href="#turtorial"></a>
</h2>
<p>This tutorial includes four parts:</p>
<ol style="list-style-type: decimal">
<li>Create traps (or detectors), state-space grid and extent, and habitat mask</li>
<li>Simulate ‘classic’ SCR data for marked individuals</li>
<li>Simulate spatial count data for unmarked individuals</li>
<li>Workflow for spatial mark-resight with 2-D trap array and habitat mask</li>
</ol>
<p><br></p>
<p>
</p>
</div>
<div class="section level2">
<h2 id="functions-used-from-localscr-package">Functions used from ‘localSCR’ package:<a class="anchor" aria-label="anchor" href="#functions-used-from-localscr-package"></a>
</h2>
<ul>
<li>
<code><a href="../reference/customize_model.html">customize_model()</a></code> delete and/or append lines from model code</li>
<li>
<code><a href="../reference/get_classic.html">get_classic()</a></code> grabs template model for given inputs using the <code><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode()</a></code> function</li>
<li>
<code><a href="../reference/get_unmarked.html">get_unmarked()</a></code> grabs spatial count model for given inputs using the <code><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode()</a></code> function</li>
<li>
<code><a href="../reference/grid_classic.html">grid_classic()</a></code> define state-space grid and extent</li>
<li>
<code><a href="../reference/initialize_classic.html">initialize_classic()</a></code> generate starting locations for activity area centers</li>
<li>
<code><a href="../reference/mask_polygon.html">mask_polygon()</a></code> create habitat mask matrix or array from polygon</li>
<li>
<code><a href="../reference/nimSummary.html">nimSummary()</a></code> summarize lists of Markov Chain Monte Carlo (MCMC) output</li>
<li>
<code><a href="../reference/realized_density.html">realized_density()</a></code> generate realized density surface from MCMC output</li>
<li>
<code><a href="../reference/rescale_classic.html">rescale_classic()</a></code> rescale inputs to prepare data for using habitat mask</li>
<li>
<code><a href="../reference/run_classic.html">run_classic()</a></code> wrapper function to run classic models using ‘nimble’ package</li>
<li>
<code><a href="../reference/sim_classic.html">sim_classic()</a></code> simulate basic spatial capture-recapture data</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load 'localSCR' package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sitkensis22.github.io/localSCR/" class="external-link">localSCR</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: nimble</span>
<span class="co">#&gt; nimble version 0.12.2 is loaded.</span>
<span class="co">#&gt; For more information on NIMBLE and a User Manual,</span>
<span class="co">#&gt; please visit https://R-nimble.org.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'nimble'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     simulate</span></code></pre></div>
<p><br></p>
<div class="section level3">
<h3 id="create-traps-or-detectors-state-space-grid-and-extent-and-habitat-mask">(1) Create traps (or detectors), state-space grid and extent, and habitat mask<a class="anchor" aria-label="anchor" href="#create-traps-or-detectors-state-space-grid-and-extent-and-habitat-mask"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulate a single trap array with random positional noise</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>
<span class="va">traps</span> <span class="op">&lt;-</span> <span class="va">traps</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimDim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">traps</span><span class="op">)</span><span class="op">)</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span> 

<span class="va">mysigma</span> <span class="op">=</span> <span class="fl">300</span> <span class="co"># simulate sigma of 300 m</span>
<span class="va">mycrs</span> <span class="op">=</span> <span class="fl">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span>
<span class="va">pixelWidth</span><span class="op">=</span><span class="fl">100</span> <span class="co"># define pixelWidth or grid resolution</span>

<span class="co"># create state-space</span>
<span class="va">Grid</span> <span class="op">=</span> <span class="fu"><a href="../reference/grid_classic.html">grid_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, buff <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="va">mysigma</span>, res <span class="op">=</span> <span class="va">pixelWidth</span><span class="op">)</span>

<span class="co"># create polygon for habitat mask</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="va">poly</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimMatrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1765</span>,<span class="op">-</span><span class="fl">1765</span>,<span class="fl">1730</span>,<span class="op">-</span><span class="fl">1650</span>,<span class="fl">1600</span>,<span class="fl">1650</span>,<span class="fl">0</span>,<span class="fl">1350</span>,<span class="op">-</span><span class="fl">800</span>,<span class="fl">1700</span>,
<span class="op">-</span><span class="fl">1850</span>,<span class="fl">1000</span>,<span class="op">-</span><span class="fl">1765</span>,<span class="op">-</span><span class="fl">1765</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span>  <span class="va">mycrs</span><span class="op">)</span>

<span class="co"># create habitat mask</span>
<span class="va">hab_mask</span> <span class="op">=</span> <span class="fu"><a href="../reference/mask_polygon.html">mask_polygon</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">poly</span>, grid <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">grid</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, 
                        prev_mask <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co"># make ggplot of grid/habitat mask and trap locations</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">grid_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Grid</span><span class="op">$</span><span class="va">grid</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,y<span class="op">=</span><span class="va">Grid</span><span class="op">$</span><span class="va">grid</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,Suitable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">hab_mask</span>,<span class="fl">2</span>,<span class="va">rev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># make 1 as the baseline level for plotting</span>
<span class="va">grid_data</span><span class="op">$</span><span class="va">Suitable</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grid_data</span><span class="op">$</span><span class="va">Suitable</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"0"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># ggplot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">grid_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,fill<span class="op">=</span><span class="va">Suitable</span>,color<span class="op">=</span><span class="va">Suitable</span><span class="op">)</span>,
                      size<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">traps</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"blue"</span>,size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Northing"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Easting"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">poly</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>datum<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">mycrs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orangered"</span>,<span class="st">"gray60"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p align="center">
<img src="../reference/figures/vignette_03/Fig1.png" style="width:70%"></p>
<br><p>
</p>
<p>Here, we use the same approach as in the first vignette in creating the state-space from <code><a href="../reference/grid_classic.html">grid_classic()</a></code>. Again, the traps (or detectors) are plotted over top of the grid in blue. We see the effect of the habitat mask shown here as red-orange points for suitable habitat and gray for unsuitable habitat; we also see the polygon used for the habitat mask plotted over top. We arbitrarily chose a grid resolution of 100 in this example (i.g., <code>res = 100</code>), but this will vary by problem. In most situations, it is prudent to test the effect of different grid resolutions on the estimated abundance and density in SCR models (see Royle et al. 2014). Also, note the use to the EPSG code to define the coordinate reference system for our state-space (see <a href="https://epsg.io/32608" class="external-link uri">https://epsg.io/32608</a>).</p>
Now lets first simulate some spatial capture-recapture data for our ‘marked’ individuals using <code><a href="../reference/sim_classic.html">sim_classic()</a></code>. Importantly, we use <code>enc_dist = "poisson"</code> to select the Poisson distribution to simulate counts rather than binary data. We will use this simulated data to produce our spatial count data of unmarked individuals. Note for this example, we will simulate a ‘true’ population size of 100 marked individuals (<code>N = 100</code>), 4 sampling occasions (<code>K = 4</code>), a scaling parameter (<code>sigma_</code>) of 300 m, a baseline encounter rate of 0.15 (<code>base_encounter = 0.15</code>), no sex-specificity (<code>prop_sex = 1</code>), and no habitat mask (<code>hab_mask = FALSE</code>). We also use <code>setSeed = 100</code> to make the simulation reproducible. Again, we provide the function the extent of the state-space output from <code><a href="../reference/grid_classic.html">grid_classic()</a></code> as <code>ext = Grid$ext</code>. Note that Grid is a list.

<p><br></p>
</div>
<div class="section level3">
<h3 id="simulate-classic-scr-data-for-marked-individuals">(2) Simulate ‘classic’ SCR data for marked individuals<a class="anchor" aria-label="anchor" href="#simulate-classic-scr-data-for-marked-individuals"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulate marked data</span>
<span class="va">data_m</span> <span class="op">=</span> <span class="fu"><a href="../reference/sim_classic.html">sim_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, 
                     sigma_ <span class="op">=</span> <span class="va">mysigma</span>, prop_sex <span class="op">=</span> <span class="fl">1</span>,N <span class="op">=</span> <span class="fl">100</span>, K <span class="op">=</span> <span class="fl">4</span>,
                     base_encounter <span class="op">=</span> <span class="fl">0.15</span>, enc_dist <span class="op">=</span> <span class="st">"poisson"</span>, 
                     hab_mask <span class="op">=</span> <span class="va">hab_mask</span>, setSeed <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="co"># inspect simulated data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data_m</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ y  : int [1:100, 1:25, 1:4] 0 0 0 0 0 0 0 1 0 0 ...</span>
<span class="co">#&gt;  $ sex: int [1:100] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ s  : num [1:100, 1:2] -657 -828 178 -1515 -108 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "sx" "sy"</span></code></pre></div>
<br><p>
</p>
<p>We can see the data list <code>data_m</code> contains 3 elements: the encounter data <code>y</code>, a vector of for <code>sex</code>, and the simulated activity centers <code>s</code>. We really only need the encounter data since we do not have any sex-specificity to the analysis problem here. Next we create another marked data set and then covert it to unmarked by summing over traps and occasions.</p>

<p><br></p>
</div>
<div class="section level3">
<h3 id="simulate-spatial-count-data-for-unmarked-individuals">(3) Simulate spatial count data for unmarked individuals<a class="anchor" aria-label="anchor" href="#simulate-spatial-count-data-for-unmarked-individuals"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulate marked data (we use a different 'setSeed' to produce different data)</span>
<span class="va">data_u</span> <span class="op">=</span> <span class="fu"><a href="../reference/sim_classic.html">sim_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, 
                     sigma_ <span class="op">=</span> <span class="va">mysigma</span>, prop_sex <span class="op">=</span> <span class="fl">1</span>,N <span class="op">=</span> <span class="fl">100</span>, K <span class="op">=</span> <span class="fl">4</span>,
                     base_encounter <span class="op">=</span> <span class="fl">0.15</span>, enc_dist <span class="op">=</span> <span class="st">"poisson"</span>, 
                     hab_mask <span class="op">=</span> <span class="va">hab_mask</span>, setSeed <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>

<span class="co"># Covert to unmarked data</span>
<span class="co"># sum over traps and occasions to produce a 2-dimensional spatial count data set</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data_u</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span>

<span class="co"># inspect n[j,k]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; int [1:25, 1:4] 1 3 2 0 0 1 0 0 0 1 ...</span></code></pre></div>
<br><p>
</p>
<p>We can see the marked data were transformed from a 3-dimensional array (<code>y[i,j,k]</code>) to a 2-dimensional array (<code>n[j,k]</code>) by summing over individuals, creating our unmarked data set called <code>n</code>.</p>
<p>Next, we’ll create the data and constants lists and all other items needed to initialize our mark-resight model. We will use <code><a href="../reference/initialize_classic.html">initialize_classic()</a></code> to generate plausible starting activity center locations for all individuals. Note that because some individuals are marked and some are unmarked, that we’ll need to separately intialize the starting locations for each data set. We’ll use the <code>all_random = TRUE</code> argument in <code><a href="../reference/initialize_classic.html">initialize_classic()</a></code> to generate all random locations for our unmarked data. Given our simulated population size of 100 marked and 100 unmarked individuals, we specify the augmented population size for each data set at 200 (<code>M = 200</code> and<code>m = 200</code>); this results in a total augmented population size of 400 individuals</p>

<p><br></p>
</div>
<div class="section level3">
<h3 id="workflow-for-spatial-mark-resight-with-2-d-trap-array-and-habitat-mask">(4) Workflow for spatial mark-resight with 2-D trap array and habitat mask<a class="anchor" aria-label="anchor" href="#workflow-for-spatial-mark-resight-with-2-d-trap-array-and-habitat-mask"></a>
</h3>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># we'll use the traps, state-space, habitat mask, and </span>
<span class="co"># data sets from above rather than recreating them here</span>

<span class="co"># Prep marked data</span>
<span class="co"># marked augmented population size </span>
<span class="va">M</span> <span class="op">=</span> <span class="fl">200</span>

<span class="co"># get initial activity center starting values for marked individuals</span>
<span class="va">s.st_m</span> <span class="op">=</span> <span class="fu"><a href="../reference/initialize_classic.html">initialize_classic</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data_m</span><span class="op">$</span><span class="va">y</span>, M<span class="op">=</span><span class="va">M</span>, X<span class="op">=</span><span class="va">traps</span>, buff <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mysigma</span><span class="op">)</span>, 
                            hab_mask <span class="op">=</span> <span class="va">hab_mask</span><span class="op">)</span>

<span class="co"># rescale inputs</span>
<span class="va">rescale_list_m</span> <span class="op">=</span> <span class="fu"><a href="../reference/rescale_classic.html">rescale_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, s.st <span class="op">=</span> <span class="va">s.st_m</span>, 
                               hab_mask <span class="op">=</span> <span class="va">hab_mask</span><span class="op">)</span>

<span class="co"># store rescaled starting activity center coordinates</span>
<span class="va">s.st_m</span> <span class="op">=</span> <span class="va">rescale_list_m</span><span class="op">$</span><span class="va">s.st</span>

<span class="co"># store rescaled extent</span>
<span class="va">ext</span> <span class="op">=</span> <span class="va">rescale_list_m</span><span class="op">$</span><span class="va">ext</span>

<span class="co"># Prep marked data</span>
<span class="co"># unmarked augmented population size </span>
<span class="va">m</span> <span class="op">=</span> <span class="fl">200</span>

<span class="co"># get initial activity center starting values for unmarked individuals</span>
<span class="va">s.st_u</span> <span class="op">=</span> <span class="fu"><a href="../reference/initialize_classic.html">initialize_classic</a></span><span class="op">(</span>y<span class="op">=</span><span class="cn">NULL</span>, M<span class="op">=</span><span class="va">m</span>, X<span class="op">=</span><span class="va">traps</span>, buff <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mysigma</span><span class="op">)</span>, 
                            hab_mask <span class="op">=</span> <span class="va">hab_mask</span>, all_random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># rescale inputs (note we'll use the traps and extent from above since </span>
<span class="co"># they are the same for all individuals, and we'll just grab s.st)</span>
<span class="va">s.st_u</span> <span class="op">=</span> <span class="fu"><a href="../reference/rescale_classic.html">rescale_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, s.st <span class="op">=</span> <span class="va">s.st_u</span>, 
                               hab_mask <span class="op">=</span> <span class="va">hab_mask</span><span class="op">)</span><span class="op">$</span><span class="va">s.st</span>

<span class="co"># create constants list</span>
<span class="va">constants</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m<span class="op">=</span><span class="va">m</span>, M <span class="op">=</span> <span class="va">M</span>,J<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimDim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data_m</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimDim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data_m</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
      n0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data_m</span><span class="op">$</span><span class="va">y</span>,<span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="va">sum</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
      x_lower <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, x_upper <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, y_lower <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, y_upper <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,
      lam0_upper <span class="op">=</span> <span class="fl">1</span>,sigma_upper <span class="op">=</span> <span class="fl">1000</span>, 
      A <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hab_mask</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">pixelWidth</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,pixelWidth<span class="op">=</span><span class="va">pixelWidth</span><span class="op">)</span>

<span class="co"># remove rows with no detections from marked data y</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">data_m</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data_m</span><span class="op">$</span><span class="va">y</span>,<span class="fl">1</span>,<span class="va">sum</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span>,,<span class="op">]</span> 
<span class="co"># convert y to 2D encounter history</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> 

<span class="co"># create combined data list </span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>,
            n <span class="op">=</span> <span class="va">n</span>, X <span class="op">=</span> <span class="va">rescale_list_m</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">hab_mask</span> <span class="op">=</span> <span class="va">hab_mask</span>
<span class="va">data</span><span class="op">$</span><span class="va">OK</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">OKu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">constants</span><span class="op">$</span><span class="va">m</span><span class="op">)</span>

<span class="co"># add z and zeros vector data for latent inclusion indicator for marked individuals</span>
<span class="va">data</span><span class="op">$</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span> <span class="op">-</span> <span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">zeros</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span> <span class="op">-</span> <span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span>

<span class="co"># define all initial values</span>
<span class="va">inits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">250</span>, <span class="fl">350</span><span class="op">)</span>,s<span class="op">=</span><span class="va">s.st_m</span>,su <span class="op">=</span> <span class="va">s.st_u</span>,
         psi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span><span class="op">)</span>,psiu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span><span class="op">)</span>,
        lam0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span><span class="op">)</span>,pOK<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">OK</span>,pOKu<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">OKu</span>,
        z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span><span class="op">-</span><span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span>,
        zu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">constants</span><span class="op">$</span><span class="va">m</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>

<span class="co"># parameters to monitor</span>
<span class="va">params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span>,<span class="st">"psi"</span>,<span class="st">"psiu"</span>,<span class="st">"lam0"</span>,<span class="st">"N"</span>,<span class="st">"Nm"</span>,<span class="st">"Nu"</span>,<span class="st">"D"</span>,<span class="st">"s"</span>,<span class="st">"z"</span>,<span class="st">"su"</span>,<span class="st">"zu"</span><span class="op">)</span>

<span class="co"># get 'classic' SCR model for marked data</span>
<span class="va">scr_model</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_classic.html">get_classic</a></span><span class="op">(</span>dim_y <span class="op">=</span> <span class="fl">2</span>, enc_dist <span class="op">=</span> <span class="st">"poisson"</span>,
                               sex_sigma <span class="op">=</span> <span class="cn">FALSE</span>,hab_mask<span class="op">=</span><span class="cn">TRUE</span>,
                                trapsClustered<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># get spatial count model for unmarked data</span>
<span class="va">sc_model</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_unmarked.html">get_unmarked</a></span><span class="op">(</span>occ_specific <span class="op">=</span> <span class="cn">FALSE</span>,
                        hab_mask<span class="op">=</span><span class="cn">TRUE</span>,trapsClustered<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># now combine models to form spatial mark-resight</span>
<span class="va">smr_model</span> <span class="op">=</span> <span class="fu"><a href="../reference/customize_model.html">customize_model</a></span><span class="op">(</span><span class="va">scr_model</span>, <span class="va">sc_model</span><span class="op">)</span>

<span class="co"># now write new model code to update smr_model lines</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-nimble.org" class="external-link">nimble</a></span><span class="op">)</span>
<span class="va">add_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">Nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">]</span><span class="op">)</span>
  <span class="va">Nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">zu</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">]</span><span class="op">)</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">Nm</span> <span class="op">+</span> <span class="va">Nu</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># erase rows and insert add_model</span>
<span class="co"># add new lines all to the same line (line 44 of the smr_model)</span>
<span class="va">smr_model2</span> <span class="op">=</span> <span class="fu"><a href="../reference/customize_model.html">customize_model</a></span><span class="op">(</span><span class="va">smr_model</span>, append_code <span class="op">=</span> <span class="va">add_model</span>,
            append_line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">44</span>,<span class="fl">3</span><span class="op">)</span>, remove_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">23</span><span class="op">:</span><span class="fl">24</span>,<span class="fl">44</span><span class="op">)</span><span class="op">)</span>

<span class="co"># inspect mark-resight model (not run)</span>
<span class="co"># smr_model2</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/collectivemedia/tictoc" class="external-link">tictoc</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># track time elapsed</span>
<span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/run_classic.html">run_classic</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">smr_model2</span>, data<span class="op">=</span><span class="va">data</span>, constants<span class="op">=</span><span class="va">constants</span>,
inits<span class="op">=</span><span class="va">inits</span>, params <span class="op">=</span> <span class="va">params</span>,niter <span class="op">=</span> <span class="fl">10000</span>, nburnin<span class="op">=</span><span class="fl">1000</span>, thin<span class="op">=</span><span class="fl">1</span>, nchains<span class="op">=</span><span class="fl">2</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>,
RNGseed <span class="op">=</span> <span class="fl">500</span>, s_alias<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>,<span class="st">"su"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 175.6 sec elapsed</span>

<span class="fu"><a href="../reference/nimSummary.html">nimSummary</a></span><span class="op">(</span><span class="va">out</span>, exclude_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>,<span class="st">"z"</span>,<span class="st">"su"</span>,<span class="st">"zu"</span><span class="op">)</span>, trace<span class="op">=</span><span class="cn">TRUE</span>,
           plot_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;       post.mean post.sd    q2.5     q50   q97.5 f0   n.eff  Rhat</span>
<span class="co">#&gt; D         0.206   0.041   0.141   0.202   0.300  1 123.795 1.057</span>
<span class="co">#&gt; N       220.077  43.200 150.000 215.000 320.000  1 123.795 1.057</span>
<span class="co">#&gt; Nm      110.097  20.580  77.000 108.000 158.000  1 217.391 1.018</span>
<span class="co">#&gt; Nu      109.980  27.535  65.000 106.000 172.000  1 156.183 1.078</span>
<span class="co">#&gt; lam0      0.143   0.039   0.081   0.139   0.221  1 236.030 1.056</span>
<span class="co">#&gt; psi       0.551   0.107   0.371   0.540   0.799  1 213.259 1.015</span>
<span class="co">#&gt; psiu      0.549   0.140   0.312   0.533   0.862  1 170.283 1.082</span>
<span class="co">#&gt; sigma   285.441  32.722 227.818 282.206 356.657  1 206.288 1.002</span></code></pre></div>
<p align="center">
<img src="../reference/figures/vignette_03/Fig2.png" style="width:70%"></p>
<br><p>
</p>
<p>We can see from the MCMC output table and trace plots that convergence is pretty good. We could run this a little longer since model run time is relatively low at 3 minutes. Both abundance estimates are near the simulated values for marked (<code>Nm = 100</code>) and unmarked (<code>Nu = 100</code>) individuals and just slightly biased high. This is to be expected given that this is just one realization of the problem.</p>
<p>We’ve shown how the template models can be combined with <code><a href="../reference/customize_model.html">customize_model()</a></code>. This might take some trial and error, but the model could always be copied and pasted into the script and wrapped with the <code><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode()</a></code> function. For most smaller model editing problems the function should be useful. Note that in our modeling exercise above we used <code>M</code> for the total augmented population size for marked individuals and used <code>m</code> for unmarked individuals.</p>
<p>Now, let’s make a realized density surfaces for marked and unmarked individuals. Note that we could add the output rasters together to make a single realized density surface for overall density.</p>

<p><br></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># generate realized density surface marked individuals</span>
<span class="va">rm</span> <span class="op">=</span> <span class="fu"><a href="../reference/realized_density.html">realized_density</a></span><span class="op">(</span>samples<span class="op">=</span><span class="va">out</span>, grid<span class="op">=</span><span class="va">Grid</span><span class="op">$</span><span class="va">grid</span>, crs_<span class="op">=</span><span class="va">mycrs</span>,
                  hab_mask<span class="op">=</span><span class="va">hab_mask</span>, z_alias <span class="op">=</span> <span class="st">"z"</span>, s_alias <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>

<span class="co"># generate realized density surface unmarked individuals</span>
<span class="va">ru</span> <span class="op">=</span> <span class="fu"><a href="../reference/realized_density.html">realized_density</a></span><span class="op">(</span>samples<span class="op">=</span><span class="va">out</span>, grid<span class="op">=</span><span class="va">Grid</span><span class="op">$</span><span class="va">grid</span>, crs_<span class="op">=</span><span class="va">mycrs</span>,
                  hab_mask<span class="op">=</span><span class="va">hab_mask</span>, z_alias <span class="op">=</span> <span class="st">"zu"</span>, s_alias <span class="op">=</span> <span class="st">"su"</span><span class="op">)</span>                     

<span class="co"># load needed packages for multiplot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://oscarperpinan.github.io/rastervis/" class="external-link">rasterVis</a></span><span class="op">)</span>

<span class="co"># plot raster for marked individuals</span>
<span class="va">p1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/rasterVis/man/gplot-methods.html" class="external-link">gplot</a></span><span class="op">(</span><span class="va">rm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="cn">NA</span>, name<span class="op">=</span><span class="st">"Density"</span>,
          limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot raster for unmarked individuals</span>
<span class="va">p2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/rasterVis/man/gplot-methods.html" class="external-link">gplot</a></span><span class="op">(</span><span class="va">ru</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="cn">NA</span>, name<span class="op">=</span><span class="st">"Density"</span>,
          limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span><span class="op">)</span><span class="op">)</span>

<span class="co"># arrange the two plots in a single row</span>
<span class="va">prow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span>,
           <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span>,
           align <span class="op">=</span> <span class="st">'vh'</span>,
           labels <span class="op">=</span> <span class="cn">NULL</span>,
           hjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
           nrow <span class="op">=</span> <span class="fl">1</span>
           <span class="op">)</span>

<span class="co"># extract the legend from one of the plots</span>
<span class="va">legend_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html" class="external-link">get_legend</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,
                        legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,
                        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,
                        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># add the legend above the row we made earlier. Give it 20% of the height</span>
<span class="co"># of one plot (via rel_heights).</span>
<span class="va">pcomb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">legend_t</span>, <span class="va">prow</span>, ncol <span class="op">=</span> <span class="fl">1</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimble-R-functions.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># add x and y axis labels</span>
<span class="va">pcomb</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html" class="external-link">annotate_figure</a></span><span class="op">(</span><span class="va">pcomb</span>, bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span><span class="st">"Easting"</span>, 
              gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="fl">18</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
              left <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span><span class="st">"Northing"</span>, rot<span class="op">=</span><span class="fl">90</span>, gp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="fl">18</span><span class="op">)</span>,
              vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="va">pcomb</span></code></pre></div>
<p align="center">
<img src="../reference/figures/vignette_03/Fig3.png" style="width:90%"></p>
<br><p>
Nice job! You’ve made it through the third ‘localSCR’ tutorial. Please see Royle et al. (2014) for more details about spatial mark-resight modeling. The next tutorial will focus on discrete state-space models or inhomogeneous point process models.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Chandler, R. B. 2018. Speeding up data augmentation in BUGS. <a href="https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE" class="external-link uri">https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE</a>.</p>
<p>de Valpine P, C. Paciorek, D. Turek, N. Michaud, C. Anderson-Bergman, F. Obermeyer, C. C. Wehrhahn, A. Rodrìguez, L. D. Temple, and S. Paganin. 2022. <em>NIMBLE: MCMC, Particle Filtering, and Programmable Hierarchical Modeling</em>. doi: 10.5281/zenodo.1211190 (URL: <a href="https://doi.org/10.5281/zenodo.1211190" class="external-link uri">https://doi.org/10.5281/zenodo.1211190</a>), R package version 0.12.2, URL:<a href="https://cran.r-project.org/package=nimble" class="external-link uri">https://cran.r-project.org/package=nimble</a>.</p>
<p>Milleret, C., P. Dupont, C. Bonenfant, H. Henrik Brøseth, Ø. Flagstad, C. Sutherland, and R. Bischof. 2019. A local evaluation of the individual state‐space to scale up Bayesian spatial capture‐recapture. Ecology and Evolution 9:352–363.</p>
<p>Turek, D., C. Milleret, T. Ergon, and H. Brøseth 2021. Efficient estimation of large‐scale spatial capture–recapture model. Ecosphere <a href="DOI:10.1002/ecs2.338" class="uri">DOI:10.1002/ecs2.338</a>5.</p>
<p>Royle, J. A., R. B. Chandler, R. Sollmann, and B. Gardner. 2014. Spatial capture‐recapture. Academic Press, Waltham, Massachusetts, USA.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniel Eacker.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
