<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function to run spatial capture-recapture models in nimble using 
parallel processing — run_classic • localSCR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function to run spatial capture-recapture models in nimble using 
parallel processing — run_classic"><meta property="og:description" content="A wrapper function to conduct Markov Chain Monte Carlo (MCMC) sampling using
 nimble."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">localSCR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/classic_scr.html">Classic SCR models: continuous state-space and marked individuals</a>
    </li>
    <li>
      <a href="../articles/unmarked_scr.html">Spatial count models: continuous state-space and unmarked individuals</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to run spatial capture-recapture models in nimble using 
parallel processing</h1>
    
    <div class="hidden name"><code>run_classic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper function to conduct Markov Chain Monte Carlo (MCMC) sampling using
 nimble.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">run_classic</span><span class="op">(</span>
  <span class="va">model</span>,
  <span class="va">data</span>,
  <span class="va">constants</span>,
  <span class="va">inits</span>,
  <span class="va">params</span>,
  niter <span class="op">=</span> <span class="fl">1000</span>,
  nburnin <span class="op">=</span> <span class="fl">100</span>,
  thin <span class="op">=</span> <span class="fl">1</span>,
  nchains <span class="op">=</span> <span class="fl">1</span>,
  parallel <span class="op">=</span> <span class="cn">FALSE</span>,
  RNGseed <span class="op">=</span> <span class="cn">NULL</span>,
  s_alias <span class="op">=</span> <span class="st">"s"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>The <code>nimbleCode</code> used to define model in <code>nimble</code> package,
possibly generated from <code><a href="get_classic.html">get_classic</a></code>.</p></dd>
<dt>data</dt>
<dd><p>A list of data inputs needed to run SCR models in <code>nimble</code>.</p></dd>
<dt>constants</dt>
<dd><p>A list of constants needed to run SCR models in <code>nimble</code>.</p></dd>
<dt>inits</dt>
<dd><p>Starting values for stochastic parameters to begin MCMC sampling.</p></dd>
<dt>params</dt>
<dd><p>A vector of character strings that define the parameters to 
trace in the MCMC simulation.</p></dd>
<dt>niter</dt>
<dd><p>An integer value of the total number of MCMC iterations to run 
per chain.</p></dd>
<dt>nburnin</dt>
<dd><p>An integer value of the number of MCMC iterations to discard 
as 'burnin'.</p></dd>
<dt>thin</dt>
<dd><p>An integer value of the amount of thinning of the chain. For 
example, <code>thin=2</code> would retain every other MCMC sample.</p></dd>
<dt>nchains</dt>
<dd><p>An integer value for the number of MCMC chains to run</p></dd>
<dt>parallel</dt>
<dd><p>A logical value indicating whether MCMC chains shoud be run 
in parallel processing. Default is <code>FALSE</code>.</p></dd>
<dt>RNGseed</dt>
<dd><p>An integer value specifying the random number generating seed 
using in parallel processing. 
This ensures that the MCMC samples will be the same during each run using the
 same data, etc. Default is <code>NULL</code>.</p></dd>
<dt>s_alias</dt>
<dd><p>A character value used to identify the latent activity center
coordinates used in the model. Default is <code>"s"</code>. Note that the length
of <code>s_alias</code> must be either 1 (e.g., <code>"s"</code>) or 2 
(e.g., <code>c("s","su")</code>).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of MCMC samples for each parameter traced with length equal to
 the number of chains run.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function provides a wrapper to easily run Bayesian SCR models
 using <code>nimble</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Daniel Eacker</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># simulate a single trap array with random positional noise</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>, <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add some random noise to locations</span></span>
<span class="r-in"><span class="va">traps</span> <span class="op">&lt;-</span> <span class="va">traps</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">traps</span><span class="op">)</span><span class="op">)</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mysigma</span> <span class="op">=</span> <span class="fl">300</span> <span class="co"># simulate sigma of 300 m</span></span>
<span class="r-in"><span class="va">mycrs</span> <span class="op">=</span> <span class="fl">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span class="r-in"><span class="va">pixelWidth</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># store pixelWidth</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">Grid</span> <span class="op">=</span> <span class="fu"><a href="grid_classic.html">grid_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, buff <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="va">mysigma</span>, </span>
<span class="r-in">res <span class="op">=</span> <span class="va">pixelWidth</span><span class="op">)</span> <span class="co"># create slightly larger buffer area for example</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create polygon to use as a mask</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">poly</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1765</span>,<span class="op">-</span><span class="fl">1765</span>,<span class="fl">1730</span>,<span class="op">-</span><span class="fl">1650</span>,<span class="fl">1600</span>,<span class="fl">1650</span>,</span>
<span class="r-in"><span class="fl">0</span>,<span class="fl">1350</span>,<span class="op">-</span><span class="fl">800</span>,<span class="fl">1700</span>,<span class="op">-</span><span class="fl">1850</span>,<span class="fl">1000</span>,<span class="op">-</span><span class="fl">1765</span>,<span class="op">-</span><span class="fl">1765</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span>  <span class="va">mycrs</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create habitat mask</span></span>
<span class="r-in"><span class="va">hab_mask</span> <span class="op">=</span> <span class="fu"><a href="mask_polygon.html">mask_polygon</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">poly</span>, grid <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">grid</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, </span>
<span class="r-in">prev_mask <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># simulate data for uniform state-space and habitat mask</span></span>
<span class="r-in"><span class="va">data3d</span> <span class="op">=</span> <span class="fu"><a href="sim_classic.html">sim_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, crs_ <span class="op">=</span> <span class="va">mycrs</span>, sigma_ <span class="op">=</span> </span>
<span class="r-in"><span class="va">mysigma</span>, prop_sex <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">200</span>, K <span class="op">=</span> <span class="fl">4</span>, base_encounter <span class="op">=</span> <span class="fl">0.15</span>, </span>
<span class="r-in">enc_dist <span class="op">=</span> <span class="st">"binomial"</span>,hab_mask <span class="op">=</span> <span class="va">hab_mask</span>, setSeed <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get initial activity center starting values</span></span>
<span class="r-in"><span class="va">s.st3d</span> <span class="op">=</span> <span class="fu"><a href="initialize_classic.html">initialize_classic</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data3d</span><span class="op">$</span><span class="va">y</span>, M<span class="op">=</span><span class="fl">500</span>, X<span class="op">=</span><span class="va">traps</span>, buff <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="va">mysigma</span>, </span>
<span class="r-in">hab_mask <span class="op">=</span> <span class="va">hab_mask</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># rescale inputs</span></span>
<span class="r-in"><span class="va">rescale_list</span> <span class="op">=</span> <span class="fu"><a href="rescale_classic.html">rescale_classic</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">traps</span>, ext <span class="op">=</span> <span class="va">Grid</span><span class="op">$</span><span class="va">ext</span>, s.st <span class="op">=</span> <span class="va">s.st3d</span>, </span>
<span class="r-in">hab_mask <span class="op">=</span> <span class="va">hab_mask</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># store rescaled extent</span></span>
<span class="r-in"><span class="va">ext</span> <span class="op">=</span> <span class="va">rescale_list</span><span class="op">$</span><span class="va">ext</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># prepare data</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">data3d</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># remove augmented records</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span>,,<span class="op">]</span> </span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> <span class="co"># covert to 2d by summing over occasions</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add rescaled traps</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">X</span> <span class="op">=</span> <span class="va">rescale_list</span><span class="op">$</span><span class="va">X</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># prepare constants</span></span>
<span class="r-in"><span class="va">constants</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">500</span>,n0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,J<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span class="r-in">                 K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data3d</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,x_lower <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, x_upper <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span class="r-in">                 y_lower <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, y_upper <span class="op">=</span> <span class="va">ext</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,sigma_upper <span class="op">=</span> <span class="fl">1000</span>, </span>
<span class="r-in">                 A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hab_mask</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">pixelWidth</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,pixelWidth<span class="op">=</span><span class="va">pixelWidth</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add z and zeros vector data for latent inclusion indicator</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span> <span class="op">-</span> <span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">zeros</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span> <span class="op">-</span> <span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add hab_mask and OK for habitat check</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">hab_mask</span> <span class="op">=</span> <span class="va">hab_mask</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">OK</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get initial activity center starting values</span></span>
<span class="r-in"><span class="va">s.st3d</span> <span class="op">=</span> <span class="va">rescale_list</span><span class="op">$</span><span class="va">s.st</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># define all initial values</span></span>
<span class="r-in"><span class="va">inits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">250</span>, <span class="fl">350</span><span class="op">)</span>, s <span class="op">=</span> <span class="va">s.st3d</span>,psi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span><span class="op">)</span>,</span>
<span class="r-in">          p0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span><span class="op">)</span>,   pOK <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">OK</span>, </span>
<span class="r-in">          z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">constants</span><span class="op">$</span><span class="va">M</span><span class="op">-</span><span class="va">constants</span><span class="op">$</span><span class="va">n0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># parameters to monitor</span></span>
<span class="r-in"><span class="va">params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span>,<span class="st">"psi"</span>,<span class="st">"p0"</span>,<span class="st">"N"</span>,<span class="st">"D"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get model</span></span>
<span class="r-in"><span class="va">scr_model</span> <span class="op">=</span> <span class="fu"><a href="get_classic.html">get_classic</a></span><span class="op">(</span>dim_y <span class="op">=</span> <span class="fl">2</span>, enc_dist <span class="op">=</span> <span class="st">"binomial"</span>,sex_sigma <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">hab_mask<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># run model</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/collectivemedia/tictoc" class="external-link">tictoc</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># track time elapsed</span></span>
<span class="r-in"><span class="va">out</span> <span class="op">=</span> <span class="fu">run_classic</span><span class="op">(</span>model <span class="op">=</span> <span class="va">scr_model</span>, data<span class="op">=</span><span class="va">data</span>, constants<span class="op">=</span><span class="va">constants</span>, </span>
<span class="r-in">      inits<span class="op">=</span><span class="va">inits</span>, params <span class="op">=</span> <span class="va">params</span>, niter <span class="op">=</span> <span class="fl">1000</span>, nburnin<span class="op">=</span><span class="fl">500</span>, </span>
<span class="r-in">      thin<span class="op">=</span><span class="fl">1</span>, nchains<span class="op">=</span><span class="fl">2</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, RNGseed <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># summarize output</span></span>
<span class="r-in"><span class="va">samples</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">out</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="st">"N"</span><span class="op">)</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">"Abundance"</span>, </span>
<span class="r-in">xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span><span class="op">)</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">200</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="co"># add line for simulated abundance</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># not run</span></span>
<span class="r-in"><span class="co">#nimSummary(out)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Eacker.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

