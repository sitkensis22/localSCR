<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Daniel Eacker" />

<meta name="date" content="2022-04-22" />

<title>Spatial count models: continuous state-space and unmarked individuals</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spatial count models: continuous
state-space and unmarked individuals</h1>
<h4 class="author">Daniel Eacker</h4>
<h4 class="date">2022-04-22</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>
The second vignette of the ‘localSCR’ package builds on ‘classic’
Bayesian spatial capture-recapture (SCR) models to introduce the spatial
count model (Royle et al. 2014). The data consist of counts of unmarked
individuals where individual identity is not possible. These models are
designed to model SCR data for ‘marked’ or ‘unmarked’ individuals under
the assumption of uniformly distributed activity centers (i.e,. a
continuous state-space). Although many distance detection functions are
possible, the package currently includes only a bivariate normal model
of space use, which is commonly employed in the literature. The package
is meant to ease implementation of Bayesian SCR models using the
‘nimble’ package (de Valpine et a. 2022), which allows for increased
flexibilty with the ability for the user to include custom functions and
assign different algorithms to specific model parameters. I took
advantage of this functionality with the goal of building a simple,
straightforward workflow that was flexible enough to handle most
mainstream SCR analysis problems. Visit <a href="https://r-nimble.org/download" class="uri">https://r-nimble.org/download</a> for information on
installing ‘nimble’ and Rtools on your computer.
</p>
<p><br></p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<p>
<p>The ‘localSCR’ package implements Bayesian spatial count models using
the ‘nimble’ package (de Valpine et a. 2022) following methods described
in Royle et al. (2014). We take advantage of recent developments in
computation of SCR models. In this tutorial, two methods are implemented
to decrease computational run time:</p>
<ol style="list-style-type: decimal">
<li>Block updating of x and y activity center coordinates (Turek et
al. 2021)</li>
<li>Using vectorized declarations for traps in distance function
calculations</li>
</ol>
<p>In some SCR problems, there are landscape features that create
‘unsuitable’ habitat for the study species. Habitat masks are used to
account for these features and designate suitable (1) or unsuitable (0)
habitat, and can be represented as a matrix or array of binary values.
We follow the methods of Milleret et al. (2019) to implement the “ones”
trick to account for habitat suitability. This restricts the possible
locations of latent activity centers to only suitable habitat. The
‘localSCR’ package provides functions to construct a habitat mask from
either raster or polygon data.</p>
Finally, in some SCR designs, clusters of trap arrays may be spread out
over the study area such that individuals can only be detected at one of
multiple trap arrays (e.g., Furnas et al. 2018). This necessitates
including the traps as a 3-dimensional array, using a site identifier to
track which site a detected or augmented individual belongs to, and
using a dynamic indexing in the model.
</p>
<p><br></p>
<p>
</div>
<div id="functions-used-from-localscr-package" class="section level2">
<h2>Functions used from ‘localSCR’ package:</h2>
<ul>
<li><code>customize_model()</code> delete and/or append lines from model
code</li>
<li><code>get_unmarked()</code> grabs spatial count model for given
inputs using the <code>nimbleCode()</code> function</li>
<li><code>grid_classic()</code> define state-space grid and extent</li>
<li><code>initialize_classic()</code> generate starting locations for
activity area centers</li>
<li><code>mask_polygon()</code> create habitat mask matrix or array from
polygon</li>
<li><code>nimSummary()</code> summarize lists of Markov Chain Monte
Carlo (MCMC) output</li>
<li><code>realized_density()</code> generate realized density surface
from MCMC output</li>
<li><code>rescale_classic()</code> rescale inputs to prepare data for
using habitat mask</li>
<li><code>run_classic()</code> wrapper function to run classic models
using ‘nimble’ package</li>
<li><code>sim_classic()</code> simulate basic spatial capture-recapture
data</li>
</ul>
</p>
<p><br></p>
<p>
</div>
<div id="turtorial" class="section level2">
<h2>Turtorial</h2>
<p>This tutorial includes five parts:</p>
<ol style="list-style-type: decimal">
<li>Create traps (or detectors) and then construct a state-space</li>
<li>Simulate ‘classic’ SCR data and covert to spatial count data<br />
</li>
<li>Workflow for 2-D trap array including habitat mask</li>
<li>Adding prior information on the scaling and encounter rate
parameters</li>
<li>Workflow for 3-D trap array including habitat mask</li>
</ol>
</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load &#39;localSCR&#39; package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(localSCR)</span></code></pre></div>
<p><br></p>
<div id="simulate-a-single-trap-array-with-random-positional-noise-and-create-state-space" class="section level3">
<h3>(1) Simulate a single trap array with random positional noise and
create state-space</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noise</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="dv">300</span> <span class="co"># simulate sigma of 300 m</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create state-space</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Grid <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> traps, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span>mysigma, <span class="at">res =</span> <span class="dv">100</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot of grid and trap locations</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Grid<span class="sc">$</span>grid),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">&quot;grey60&quot;</span>, <span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(traps),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<br>
<p align="center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAApVBMVEUAAAAAADoAAGYAAP8AOpAAZrYzMzM6AAA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmtrZmtv9uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQkGaQ2/+ZmZmrbk2rbm6rbo6ryKur5P+2ZgC2tma225C2///Ijk3I///bkDrb/7bb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T////Gj0IRAAAN9klEQVR4nO3cDVvb1gGGYVp3bpwQtjSfdC1tyTacjY+Ca/3/nzbLhmADieS8ki1b9331iraQc3KQn8iyOXBQQOBg2wtgtwmIiICICIhIFpD8ek9ARAREREBEBEREQEQERERARAREREBEBEREQEQERKTBgH59/PEnfqvmH+vISMuomqy5gH799dH8T/xWzT/WkZGWUTWZK5BlZJO5ByIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiYkeiZUST2RNtGfZEtzfSMqomcw9EREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERMSORMuIJrMn2jLsiW5vpGVUTeYeiIiAiAiIiICICIiIgIgIiIiAiAiISFUC16/HRTF5Nzq8eHioM5q9V5HA1ejFuJieHBfnLx8c6oxm/309gbPnf8yuQJMP4/JKtHqoMZoeqPMUdv3mopi8P109FMVwOBRQ79UJ6OpwnszqodZo9l5wBaoxmr1XJyD3QHxRnYCmJ28XL7+WD7VGs/cafB+ouzvp9nIrYEeWYU+0ZdgT3d5Iy6iazNfCiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIjYkWgZ0WT2RFuGPdHtjbSMqsncAxEREBEBEREQEQERERCRHQloMBhs6q9iLbsR0GCgoI4SEBEBEdmNgNwDddaOBNRVwhZQottPrRtZWw8DavC8djqgzSyufwE1eV4bfYyafrgF1I6uPuiNP94CakdXn3aaX9eu3QN1dyfd6u8tzuvWl/Hwtz4H1N3zaE90p5dx189OnY0+XoEso8nJ+ncPRKMERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jGgye6Itw57o9kZaRtVk7oGICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiNiRaBnRZPZEW4Y90e2NtIyqydwDEREQEQERERARAREREBEBEREQEQERqZXA+Wg0ejEuJu9GhxfF3aH2aPZZrQTOjstfpyfHxfnLu0P90eyzOglMfzstD5MP4+L69fj2UHs0e61OArPnrNHouLh+c1FM3p/eHopiOBwKqPfqJHD902l5Fbo6nJdze6g9mr1WO4Gz44dXoHVGs6/WCMg9EI/VSaB80pr+Pp6evF28CnvrVRh36r4P9Py0qHofqLs76fZyK2BHlmFPtGXYE93eSMuomszXwogIiIiAiAiIiICICIiIgIgIqDMGg8G2l/ANBNQVg8FOFtSzgDr8GAloB3T5Qery2r5CQJ3R8NI29JnuSkDNnI5OB9SsTX2qOxJQU6ej6ZPa3R4FtKKjl46OLqskoBUdfaQ6uqw590AruvlAdTmgDbEjMZrstp9tL2NDI+2Jtoyml+EKZBnZZLtyD0RHCYiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiC2tlhFNZlO9ZdhU395Iy6iazD0QEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jmsyeaMtoaE/0zdHBnVeP/9zTXIF6v4ylBC4Pns1/fXVz9OyJP/kU90C9d5/AXz//bX789MP/Zv+tO5qeWn4KWzxzXX7/n9l/646mp5avQIsnrvIKJCBqeuoe6O7JbK3R9NNyAvPXYbOLz8e6FyAB4Z1oIgIispTAXz8v3kas/QQmIJYTqH/r89Ro+mn5faC67z8/NZqeevxG4reNpqcefynj20bTUytvJK59CRJQ7z2xncOrMOrzPhARARGxJ9oyosluE7g5epbeA3V3L+9ebkbuyDJcgSwjm8w9EBFfTCXii6lEfDGViC+mEvHFVCJLCfz5oy+msq7PbyR+/sZ4r8L2wGAw2NDf5H2gfTQYbKygpZvov/8yP1Z+X/Pk3ejw4uHoHbK5f51bs9WAqr6veXpyXJy/fDh6d2zw5G7NFgL6eH8PVPF20OTDuLh+PV4ZvUs6HVBTS9vGPdDdFajK9ZuLYvL+tCiGw+EGAmr8VDQXUPOPUqfjftrjn85R5erwNqBiE1egFk5pg/10N+6NWf+d6M9XoGJHA2qKgErL35VR7w2gzd4DdfiUtrG0zn6yX7T+d2VMT95u8lVYh09ph5e2Od+QwJfeB+ruTrq93ArYkWX4OdGW0die6D9/nD2BfVfvxfzj0R3+l7OX//Q7soxHPyPx0zrf4LyLbyTSqCd/Sus3jKannvw50d8wmp5yBSLiHohIg6/C6CM7EokIiIhN9UQeJfCxakfiV0fTNw8SmF2J1vnmMAH13moCl+s8fz0aTQ+tJPDpYI03ER+Npo9Wfz7Quj+fQ0C9t7Ij0ffGs67PCax7+7M6mr66S+DTwfo/3EVANPlGYnd30u3lVsCOLMOeaMtobE/0+lyBer8MX0wlIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICImJHomVEk9kTbRn2RLc30jKqJnMPRERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBETEjkTLiCazJ9oy7Ilub6RlVE3mHoiIgIgIiIiAiAiIiICICIhIHwMaDAbbXsL+2JWAGnzQB4NOFtTJRVXbkYCafNCbmqvZR7yjWVcS0JanaWe6zcXYw4AaOrtdDmiDl7MdCaiDdwhNP0gNX4AE1Hnda/ozAZFxD8SOEBAROxItI5rMnmjLsCe6vZGWUTWZeyAiAiIiICICIiIgIgIiIiAiAiIiICK1EjgfjUYvxsXk3ejworg71B7NPquVwNlx+ev05Lg4f3l3qD+afVYngelvp+Vh8mFcXL8e3x5qj2av1Ulg9pw1Gh0X128uisn709tDUQyHQwH1Xp0Ern86La9CV4fzcm4PtUez16oSOBuNFvc7Z8cPr0A1RrP3aidwduweiMfqJFA+aU1/H09P3i5ehb31Kow7dd8Hen5aVL0P1N2ddHu5FbAjy7An2jLsiW5vpGVUTeZrYUQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jGgye6Itw57o9kZaRtVk7oGICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiNiRaBnRZPZEW4Y90e2NtIyqydwDEREQEQERERARAREREBEB7a/BYND+X7IrAW3kZGxT85/gYLCJk7YjAW3mZGxRC5+ggJY0dDLaeJAam0hALWrmZDR+SpubsI1H2z3QkqYuQF0NaGdv8nYloEZ0OaBd1auAOnwPtLP6FRCNExARARGxI9EyosnsibYMe6LbG2kZVZO5ByIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiYkeiZUST2RNtGfZEtzfSMqomcw9EREBEBEREQEQERERARAREREBEBESkKoHr1+OimLwbHV48PNQZzd6rSOBq9GJcTE+Oi/OXDw51RrP/vp7A2fM/ZlegyYdxeSVaPdQYTQ/UeQq7fnNRTN6frh6KYjgcCqj36gR0dThPZvVQazR774sJnI1G5Y3OV65AXxtNX9S5ArkH4ovqBDQ9ebt4+bV8qDWavdfg+0Dd3Um3l1sBO7IMe6Itw57o9kZaRtVkvhZGREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERMSORMuIJrMn2jLsiW5vpGVUTeYeiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIHYmWEU1mT7Rl2BPd3kjLqJrMPRARAREREBEBEREQEQERERARAREREBEBEREQEQERCQNKDeMZtjt/nz+BJgKKDXd8fp+AgLr9F3T+E3AXQ0RARAREREBEthPQ9etxUUzejQ4vHh4acj4ajV6M25n7Xlvztr78Bs//VgK6Ks/O9OS4OH/54NCUs+Py13bm/qyteVtffpPnfxsBnT3/Y/YvYPJhXP5LWD009DdMfzstD63Mfa+tedtefqPnf3tPYddvLorJ+9PVQ0Pzz67Ho9Fx0crc99qat/3lN3j+txfQ1eF8yauHpub/6bT8Z9zK3Pfamrf95Td4/jcc0NloVD7RtnkFuv0ryhuJXb0CzbW5/L24ArV5DzR3dryr90BzbS6/wfO/vYCmJ28Xt//Lh4aUF+Tp7+NW5r7X1rztL7/B87+/7wM9P21p7nttvg/U6vJ3/X0g9oeAiAiIiICICIiIgIgIqMrH229C+OF/jz92+aq4OXq1+TV1iICqfHyqnIW+x1MSUBUBfZWAqiwHVD6dlc38+WP5P8pff/jvUfk09o+jxQdmf+C7f373y9YWu3kCqrIU0Me/FcWnWR5//jiL5fLg1c3R4h7o5mj2m+UHPn7/n9nvC4gldzfRz4qbv/9SzOO5nHVSug/o2fwD87CKjwJiyeo90GX5VHVztCjoPqBX8/+zCOtSQCxZCujTwcH3/y6vMn/9fLAIaTWgTwLikfuA5s9Qi6epYv5M5QokoGr3Ac37uDy4DWgWzMOAFnF9EhBLVq9AN0ezu+n5NeayvAI9WwnIqzAeu3sVVr5SL38tX2RdLv7/7GO37wPdBlT+4e//dfsarR8E1LhLAfFt5vdA8zeF+kNATSqf2g769fUxAREREBEBEREQEQER+T9vCRW+Oh5tcwAAAABJRU5ErkJggg==" style="width:70%" />
</p>
<br>
<p>
<p>Here, we use the same approach as in the first vignette in creating
the state-space from <code>grid_classic()</code>. Again, the traps (or
detectors) are plotted over top of the grid in blue. We arbitrarily
chose a grid resolution of 100 in this example (i.g.,
<code>res = 100</code>), but this will vary by problem. In most
situations, it is prudent to test the effect of different grid
resolutions on the estimated abundance and density in SCR models (see
Royle et al. 2014). Also, note the use to the EPSG code to define the
coordinate reference system for our state-space (see <a href="https://epsg.io/32608" class="uri">https://epsg.io/32608</a>).</p>
Now lets first simulate some spatial capture-recapture data using
<code>sim_classic()</code>. Importantly, we use
<code>enc_dist = &quot;poisson&quot;</code> to select the Poisson distribution to
simulate counts rather than binary data. We will use this simulated data
to produce our spatial count data of unmarked individuals. Note for this
example, we will simulate a ‘true’ population size of 200 individuals
(<code>N = 200</code>), 4 sampling occasions (<code>K = 4</code>), a
scaling parameter (<code>sigma_</code>) of 300 m, a baseline encounter
rate of 0.10 (<code>base_encounter = 0.10</code>), no sex-specificity
(<code>prop_sex = 1</code>), and no habitat mask
(<code>hab_mask = FALSE</code>). We also use <code>setSeed = 100</code>
to make the simulation reproducible. Again, we provide the function the
extent of the state-space output from <code>grid_classic()</code> as
<code>ext = Grid$ext</code>. Note that Grid is a list.
</p>
<p><br></p>
</div>
<div id="simulate-scr-data-and-convert-it-to-spatial-count-data" class="section level3">
<h3>(2) Simulate SCR data and convert it to spatial count data</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate SCR data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data3d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sigma_ =</span> mysigma, <span class="at">prop_sex =</span> <span class="dv">1</span>,<span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">base_encounter =</span> <span class="fl">0.10</span>, <span class="at">enc_dist =</span> <span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hab_mask =</span> <span class="cn">FALSE</span>, <span class="at">setSeed =</span> <span class="dv">100</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect simulated data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data3d)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ y  : int [1:200, 1:25, 1:4] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sex: int [1:200] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ s  : num [1:200, 1:2] -662 -834 177 -1526 -110 ...</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;sx&quot; &quot;sy&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># We sum over traps and occasions to produce a 2-dimensional spatial count data set</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">apply</span>(data3d<span class="sc">$</span>y, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), sum)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect n[j,k]</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(n)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; int [1:25, 1:4] 0 3 2 0 1 1 1 1 1 1 ...</span></span></code></pre></div>
<br>
<p>
<p>We can see the data were transformed from a 3-dimensional array
(<code>y[i,j,k]</code>) to a 2-dimensional array (<code>n[j,k]</code>)
by summing over traps and occasions. In the spatial count model, we
cannot identify individuals but we can observe a count of unmarked
individuals at each occasion and trap (Royle et al. 2014). In general,
this model depends on spatial autocorrelation in the observations to
estimate model parameters. We’ll see how the estimates compare to a
problem with marked individuals that was presented in the first vignette
by running an analogous spatial count modeling problem . We’ll use the
same trap array but set a single scaling parameter (<code>sigma_</code>)
of 300 m.</p>
<p>We add on an additional layer of complexity by introducing a habitat
mask. After constructing a polygon feature using the ‘sf’ package, we
then use the function <code>mask_polygon()</code> to build a habitat
mask as a matrix object. The habitat matrix is either ‘0’ (unsuitable)
or ‘1’ (suitable). In the habitat matrix the rows represent the
y-coordinate (“Northing”) of the state-space grid and the columns
represent the x-coordinate (“Easting”) of the state-space grid. We’ll
use this habitat matrix as data below in this part of the tutorial.</p>
We also see the use of <code>initialize_classic()</code>, which
generates plausible starting activity center locations for all
individuals. Note that because all individuals are unmarked here, we’ll
use the <code>all_random = TRUE</code> argument in
<code>initialize_classic()</code> to generate all random locations to
initalize the activity center coordinates. Given our simulated
population size of 200, we specify the total augmented population size
(all augmented individuals) at 400 (<code>M = 400</code>).
</p>
<p><br></p>
</div>
<div id="workflow-for-spatial-count-model-with-poisson-encounter-distribution-and-habitat-mask-using-a-2d-trap-array." class="section level3">
<h3>(3) Workflow for spatial count model with Poisson encounter
distribution and habitat mask using a 2D trap array.</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noisee</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) <span class="co"># add some random noise to locations</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="dv">300</span> <span class="co"># simulate a single scaling parameter</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>pixelWidth <span class="ot">=</span> <span class="dv">100</span> <span class="co"># store pixelWidth or grid resolution</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create state-space grid and extent</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>Grid <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> traps, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), <span class="at">res =</span> pixelWidth) </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create polygon for mask</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>poly <span class="ot">=</span> <span class="fu">st_sfc</span>(<span class="fu">st_polygon</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1765</span>,<span class="sc">-</span><span class="dv">1765</span>,<span class="dv">1730</span>,<span class="sc">-</span><span class="dv">1650</span>,<span class="dv">1600</span>,<span class="dv">1650</span>,<span class="dv">0</span>,<span class="dv">1350</span>,<span class="sc">-</span><span class="dv">800</span>,<span class="dv">1700</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1850</span>,<span class="dv">1000</span>,<span class="sc">-</span><span class="dv">1765</span>,<span class="sc">-</span><span class="dv">1765</span>),<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))), <span class="at">crs =</span>  mycrs)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># create habitat mask</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>hab_mask <span class="ot">=</span> <span class="fu">mask_polygon</span>(<span class="at">poly =</span> poly, <span class="at">grid =</span> Grid<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">prev_mask =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for uniform state-space and habitat mask</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>data3d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma_ =</span> mysigma, <span class="at">prop_sex =</span> <span class="dv">1</span>,<span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">base_encounter =</span> <span class="fl">0.3</span>, <span class="at">enc_dist =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">hab_mask =</span> hab_mask, <span class="at">setSeed =</span> <span class="dv">100</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># total augmented population size </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>s.st3d <span class="ot">=</span> <span class="fu">initialize_classic</span>(<span class="at">y=</span><span class="cn">NULL</span>, <span class="at">M=</span>M, <span class="at">X=</span>traps, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                            <span class="at">hab_mask =</span> hab_mask, <span class="at">all_random=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Grid<span class="sc">$</span>grid),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span> </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(traps),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(s.st3d),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color =</span> <span class="st">&quot;orangered&quot;</span>,<span class="at">size=</span><span class="fl">2.5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>poly, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">datum=</span><span class="fu">st_crs</span>(mycrs)) <span class="sc">+</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span> </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span> </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
<p>In the figure above we can see the effect of the polygon in creating
a habitat mask for the state-space. The
<code>initialize_classic()</code> function contains the initial activity
center locations to within the polygon (note that those points on the
edges were in suitable habitat when the continuous location were
discretized and checked with the habitat mask).</p>
<p>We now have most of the components we will need to analyze the
simulated data set. However, because we are using a habitat mask in the
model (<code>hab_mask</code>), we must rescale the traps, grid extent,
and initial activity center locations. To run the spatial count model
using the template model from <code>get_unmarked()</code>, we’ll need to
change the paramter names <code>&quot;s&quot;</code> and <code>&quot;z&quot;</code> to
<code>&quot;su&quot;</code> and <code>&quot;zu&quot;</code> in <code>params</code> to denote
that these are unmarked individuals. We also set the
<code>s_alias = &quot;su&quot;</code> argument in <code>run_classic()</code>. This
allows the block updating of x- and y- activity center coordinates to
function properly. Additionally, we have the <code>zu</code> parameter
initialized with <code>rbinom</code> rather than separating the data
augmentation as in vignette 1 with the marked individuals.</p>
<p>Because the model uses the Poisson encounter distribution, we also
need to intialize the encounter rate <code>lam0</code> rather than the
encounter probability <code>p0</code> as in the binomial likelihood. We
also need to add <code>lam0</code> to <code>params</code> and
<code>lam0_upper</code> to <code>constants</code> given the default
uniform distribution used in the model (i.e.,
<code>lam0 ~ dunif(0, lam0_upper)</code>).</p>
</p>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale inputs</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rescale_list <span class="ot">=</span> <span class="fu">rescale_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">s.st =</span> s.st3d, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># store rescaled extent</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ext <span class="ot">=</span> rescale_list<span class="sc">$</span>ext</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data by summing over traps and occasions and add to list</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">apply</span>(data3d<span class="sc">$</span>y, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), sum))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add rescaled traps</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>X <span class="ot">=</span> rescale_list<span class="sc">$</span>X</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare constants (note get density in activity center/100 m2 rather than activity centers/m2)</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>constants <span class="ot">=</span> <span class="fu">list</span>(<span class="at">M =</span> M,<span class="at">J=</span><span class="fu">dim</span>(data3d<span class="sc">$</span>y)[<span class="dv">2</span>], <span class="at">K=</span><span class="fu">dim</span>(data3d<span class="sc">$</span>y)[<span class="dv">3</span>],</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="at">x_lower =</span> ext[<span class="dv">1</span>], <span class="at">x_upper =</span> ext[<span class="dv">2</span>], <span class="at">y_lower =</span> ext[<span class="dv">3</span>], <span class="at">y_upper =</span> ext[<span class="dv">4</span>],</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="at">lam0_upper =</span> <span class="dv">1</span>,<span class="at">sigma_upper =</span> <span class="dv">1000</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="at">A =</span> (<span class="fu">sum</span>(hab_mask)<span class="sc">*</span>(pixelWidth<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),<span class="at">pixelWidth=</span>pixelWidth)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add hab_mask and OK for habitat check</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>hab_mask <span class="ot">=</span> hab_mask</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>OK <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>M)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>s.st <span class="ot">=</span> rescale_list<span class="sc">$</span>s.st</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># define all initial values</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sigma =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">250</span>, <span class="dv">350</span>), <span class="at">su =</span> s.st,<span class="at">psi=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="at">lam0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span>),<span class="at">pOK=</span>data<span class="sc">$</span>OK,<span class="at">zu=</span><span class="fu">rbinom</span>(constants<span class="sc">$</span>M,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;psi&quot;</span>,<span class="st">&quot;lam0&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;su&quot;</span>,<span class="st">&quot;zu&quot;</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># get spatial count model</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>sc_model <span class="ot">=</span> <span class="fu">get_unmarked</span>(<span class="at">occ_specific =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">hab_mask=</span><span class="cn">TRUE</span>,<span class="at">trapsClustered=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># run model (note we set s_alias to &quot;su&quot; for spatial count model)</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> sc_model, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="at">RNGseed =</span> <span class="dv">500</span>, <span class="at">s_alias=</span><span class="st">&quot;su&quot;</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 511.62 sec elapsed</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize output</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">do.call</span>(rbind, out)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples[,<span class="fu">which</span>(<span class="fu">dimnames</span>(out[[<span class="dv">1</span>]])[[<span class="dv">2</span>]]<span class="sc">==</span><span class="st">&quot;N&quot;</span>)], <span class="at">xlab =</span> <span class="st">&quot;Abundance&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">500</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">200</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># add line for simulated abundance</span></span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
<p>Besides taking longer to run, we can see from the histogram of the
posterior samples of <code>N</code> that convergence is somewhat poor.
This is not surprising given that the model is asking so much of the
data in trying to estimate the number of individuals from observing a
count of unmarked individuals for a given occasion and trap. We could
try increasing the number of iterations, but this is likely futile since
there simply is not enough information. We have some other options that
we’ll explore in the next part of the tutorial.</p>
<p>In this example, we divided the pixelWidth by 100 in deriving the
area (<code>A</code>) in our list of constants. This allowed us to
estimate density in activity centers/100 m<sup>2</sup> rather than
activity centers/m<sup>2</sup>. Note that care must be taken with any
rescaling of the data or constants.</p>
Next we use<code>nimSummary()</code> to quickly summarize the MCMC
samples. Note that there are other options to summarize MCMC output, but
this function is provided with the package and depends partly on the
‘coda’ package.
</p>
<p><br></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize MCMC samples (exclude parameters and don&#39;t plot)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nimSummary</span>(out, <span class="at">exclude_params =</span> <span class="fu">c</span>(<span class="st">&quot;su&quot;</span>,<span class="st">&quot;zu&quot;</span>), <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       post.mean post.sd    q2.5     q50   q97.5 f0  n.eff  Rhat</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D         0.234   0.121   0.040   0.221   0.453  1 33.817 1.121</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N       250.204 129.023  43.000 237.000 485.000  1 33.817 1.121</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lam0      0.385   0.238   0.065   0.357   0.906  1 68.708 1.020</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi       0.500   0.258   0.086   0.475   0.968  1 33.594 1.119</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma   344.133 202.596 146.564 270.782 932.274  1 31.582 1.282</span></span></code></pre></div>
<br>
<p>
Although we are able to produce estimates, they are not reliable due to
the lack of convergence and huge uncertainty. This will be the case for
many spatial count modeling problems and thus, it is common to include
prior information or combine marked and unmarked individuals into a
spatial mark-resight analysis (the topic of vignette 3). Here, we’ll
test out the effect of bringing in prior information on the scaling
parameter; this could occur if we had estimates of <code>sigma</code>
from a previous study or another data source.We’ll first need to use a
moment matching function (e.g., normal to gamma moments) from the
‘modeltools’ package (add citation) called <code>estGammaParam()</code>.
The gamma distribution is appropriate since it has support from 0 to
infinity. For this example, we’ll just grab some estimates of posterior
standard error from part 3 of vignette 1. We know the ‘true’ simulated
value of sigma is 300.
</p>
<p><br></p>
</div>
<div id="adding-prior-information-on-the-scaling-and-encounter-rate-parameters" class="section level3">
<h3>(4) Adding prior information on the scaling and encounter rate
parameters</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get from Github and load</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github(&quot;austinnam/modeltools&quot;,force=TRUE) </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modeltools)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get &#39;alpha&#39; and &#39;beta&#39; parameters of Gamma distribution</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>gparam <span class="ot">=</span> <span class="fu">estGammaParam</span>(<span class="at">mu =</span> mysigma, <span class="at">sigma =</span> <span class="dv">30</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># view prior distribution for sigma (scaling parameter)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rgamma</span>(<span class="dv">100000</span>,<span class="at">shape=</span>gparam<span class="sc">$</span>alpha,<span class="at">rate=</span><span class="dv">1</span><span class="sc">/</span>gparam<span class="sc">$</span>beta),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Gamma prior&quot;</span>)</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
To add our prior information, we’ll use <code>customize_model()</code>
to edit our previously created model. Then, we’ll rerun the model using
<code>run_classic</code>.
</p>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define new code to replace line 3 in &#39;sc_model&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>new_prior <span class="ot">=</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>   sigma <span class="sc">~</span> <span class="fu">dgamma</span>(alpha, <span class="dv">1</span><span class="sc">/</span>beta) <span class="co"># note that dgamma takes rate (1/beta)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># delete old prior on line 3 and replace with new prior </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sc_model_inf <span class="ot">=</span> <span class="fu">customize_model</span>(<span class="at">model =</span> sc_model, <span class="at">append_code =</span> new_prior,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">append_line=</span><span class="dv">3</span>,<span class="at">remove_line=</span><span class="dv">3</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model (not run)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sc_model_inf</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add &#39;alpha&#39; and &#39;beta&#39; to list of constants</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>alpha <span class="ot">=</span> gparam<span class="sc">$</span>alpha</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>beta <span class="ot">=</span> gparam<span class="sc">$</span>beta</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># run model (note we set s_alias to &quot;su&quot; for spatial count model)</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> sc_model_inf, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="at">RNGseed =</span> <span class="dv">500</span>,<span class="at">s_alias=</span><span class="st">&quot;su&quot;</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 836.56 sec elapsed</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize output</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">do.call</span>(rbind, out)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples[,<span class="fu">which</span>(<span class="fu">dimnames</span>(out[[<span class="dv">1</span>]])[[<span class="dv">2</span>]]<span class="sc">==</span><span class="st">&quot;N&quot;</span>)], <span class="at">xlab =</span> <span class="st">&quot;Abundance&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">500</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">200</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># add line for simulated abundance</span></span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<p><br></p>
<p>
Again, we see that convergence is not great despite having prior
information on sigma, but it’s an improvement and the median estimate of
N is close to the simulated value of 200. The uncertainty both the
encounter rate <code>lam0</code> and the augmentation parameter
<code>psi</code> is still huge, which translates into large uncertainty
in abundance. We can try adding prior information about the encounter
rate as well and see how this affects the estimates. We’ll use a similar
strategy as we did for the scaling parameter ‘sigma’.
</p>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define new code to replace line 3 in &#39;sc_model&#39;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>new_prior <span class="ot">=</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   lam0 <span class="sc">~</span> <span class="fu">dgamma</span>(alpha_lam0, <span class="dv">1</span><span class="sc">/</span>beta_lam0) <span class="co"># note that dgamma takes rate (1/beta)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># delete old prior on line 3 and replace with new prior </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>sc_model_inf2 <span class="ot">=</span> <span class="fu">customize_model</span>(<span class="at">model =</span> sc_model_inf, <span class="at">append_code =</span> new_prior,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">append_line=</span><span class="dv">2</span>,<span class="at">remove_line=</span><span class="dv">2</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model (not run)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sc_model_inf2</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get &#39;alpha&#39; and &#39;beta&#39; parameters of Gamma distribution</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>lam0_param <span class="ot">=</span> <span class="fu">estGammaParam</span>(<span class="at">mu =</span> <span class="fl">0.30</span>, <span class="at">sigma =</span> <span class="fl">0.03</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add &#39;alpha&#39; and &#39;beta&#39; to list of constants</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>alpha_lam0 <span class="ot">=</span> lam0_param<span class="sc">$</span>alpha</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>beta_lam0 <span class="ot">=</span> lam0_param<span class="sc">$</span>beta</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># run model (note we set s_alias to &quot;su&quot; for spatial count model)</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> sc_model_inf2, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="at">RNGseed =</span> <span class="dv">500</span>,<span class="at">s_alias=</span><span class="st">&quot;su&quot;</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1193.95 sec elapsed</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize output (exclude &quot;su&quot; and &quot;zu&quot; from table and make posterior/trace plots)</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="fu">nimSummary</span>(out, <span class="at">exclude_params =</span> <span class="fu">c</span>(<span class="st">&quot;su&quot;</span>,<span class="st">&quot;zu&quot;</span>), <span class="at">trace=</span><span class="cn">TRUE</span>, <span class="at">plot_all=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       post.mean post.sd    q2.5     q50   q97.5 f0    n.eff  Rhat</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D         0.223   0.053   0.137   0.219   0.343  1  275.831 1.001</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N       238.946  56.449 147.000 234.000 367.000  1  275.831 1.001</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lam0      0.298   0.029   0.244   0.297   0.358  1 1374.996 1.000</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi       0.478   0.114   0.288   0.468   0.737  1  287.766 1.001</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma   287.307  28.393 234.682 286.116 346.612  1  301.998 1.013</span></span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
<p>We can see that convergence is improved by a decent margin with the
addition of prior information but a considerable amount of uncertainty
still exists in abundance <code>N</code> which has around a 23.6%
(56.4/239.0*100) coefficient of variation (CV). The estimate of
abundance is about 239 individuals, which is biased slightly highly
high. Regardless, this example shows that without prior information (or
sharing of parameters with other data sources such as in a mark-resight
approach), the spatial count model struggles to make inference to
abundance on its own. We also note a substantial increase in model run
time up to 20 minutes on our machine (albeit on a somewhat slow
laptop).</p>
Finally, we make a realized density plot of the MCMC samples using
<code>realized_density()</code>. In this function we make use of the
list of grid and extent we created earlier called <code>Grid</code> as
well as our saved coordinates reference system (<code>mycrs</code>). In
this example, we use the ‘raster’ package to make a simple plot of the
output. We can see that the habitat mask has resulted in some cells
having <code>NA</code> values where the habitat was unsuitable.
</p>
<p><br></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make realized density plot (need to specify s_alias and z_alias)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">realized_density</span>(<span class="at">samples =</span> out, <span class="at">grid =</span> Grid<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, <span class="at">site =</span> <span class="cn">NULL</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hab_mask =</span> hab_mask, <span class="at">s_alias =</span> <span class="st">&quot;su&quot;</span>, <span class="at">z_alias =</span> <span class="st">&quot;zu&quot;</span>)       </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load virdiis color palette and raster libraries      </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make simple raster plot</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">100</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">expression</span>(<span class="st">&quot;Realized density (activity centers/100 m&quot;</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Northing&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Easting&quot;</span>)</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<p><br></p>
<p>
<p>We demonstrated the ability of functions such as
<code>customize_model()</code> to efficiently edit model code without
have to copy and paste a large amount of text. We used ‘sim_classic()’
to first generate a 3-dimensional encounter history data set for marked
individuals, and then we summed over traps and occasions to arrive at a
spatial count data set (<code>n[j,k]</code>).</p>
<p>As a final step example in this tutorial, we demonstrate the ability
of the ‘localSCR’ package to aid in analyzing a spatial count model when
we have clustered trap arrays (i.e., trap arrays that are spaced out far
enough that individuals can only be detected on one array). The workflow
will be similar to part 3 in our example, except that we’ll need to
create an indexing to allocate augmented individuals to the correct trap
array. For this, we’ll create the objects <code>site_indexL</code> and
<code>site_indexU</code> and we will see this index in the model as
<code>site_indexL[g]:site_indexU[g]</code>. We’ll also use the same
informative priors the we developed above in part 4.</p>
</p>
</div>
<div id="workflow-for-spatial-count-model-with-poisson-encounter-distribution-and-habitat-mask-using-a-3d-trap-array-or-clustered-trap" class="section level3">
<h3>(5) Workflow for spatial count model with Poisson encounter
distribution and habitat mask using a 3D trap array or clustered
trap</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noise</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="dv">300</span> <span class="co"># simulate single scaling parameter</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>pixelWidth <span class="ot">=</span> <span class="dv">100</span> <span class="co"># store pixelWidth</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create an array of traps, as an approach where individuals will only be detected </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># at one of the trap arrays (e.g., Furnas et al. 2018)</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>Xarray <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(traps),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>Xarray[,,<span class="dv">1</span>]<span class="ot">=</span>traps</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Xarray[,,<span class="dv">2</span>]<span class="ot">=</span>traps<span class="sc">+</span><span class="dv">4000</span> <span class="co"># shift trapping grid to new locations</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create grid and extent for 3D trap array</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>GridX <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> Xarray, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), <span class="at">res =</span> <span class="dv">100</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># create polygon to use as a mask</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>poly <span class="ot">=</span> <span class="fu">st_sfc</span>(<span class="fu">st_polygon</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1660</span>,<span class="sc">-</span><span class="dv">1900</span>,<span class="dv">5730</span>,<span class="sc">-</span><span class="dv">1050</span>,<span class="dv">5470</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="dv">5650</span>,<span class="dv">0</span>,<span class="dv">6050</span>,<span class="sc">-</span><span class="dv">1800</span>,<span class="dv">5700</span>,<span class="sc">-</span><span class="dv">1660</span>,<span class="sc">-</span><span class="dv">1900</span>),<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))), <span class="at">crs =</span>  mycrs)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(GridX<span class="sc">$</span>grid[,,<span class="dv">1</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,<span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Xarray[,,<span class="dv">1</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(GridX<span class="sc">$</span>grid[,,<span class="dv">2</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Xarray[,,<span class="dv">2</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>poly, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">datum=</span><span class="fu">st_crs</span>(mycrs)) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2000</span>,<span class="dv">6000</span>)) <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2000</span>,<span class="dv">6000</span>)) <span class="sc">+</span> </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
In the figure we can see our two spatially separated trapping grids and
that the polgon overlaps some of the gridded area. The area outside the
polygon will be considered unsuitable when the habitat matrix is
created. Note that the <code>site</code> variable will be only as long
as the simulated population size (here, 200) and thus, we will need to
augment the variable to have the length equal to the total augmented
population size (i.e., <code>M = 400</code>). Otherwise the workflow is
very similar to the previous one.
</p>
<p><br></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get 3D habitat mask array for 3D grid</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>hab_mask <span class="ot">=</span> <span class="fu">mask_polygon</span>(<span class="at">poly =</span> poly, <span class="at">grid =</span> GridX<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, <span class="at">prev_mask =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for uniform state-space and habitat mask (N is simulated abundance)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data4d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> Xarray, <span class="at">ext =</span> GridX<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sigma_ =</span> mysigma,<span class="at">prop_sex =</span> <span class="dv">1</span>,<span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>,  </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">base_encounter =</span> <span class="fl">0.3</span>, <span class="at">enc_dist =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hab_mask =</span> hab_mask, <span class="at">setSeed =</span> <span class="dv">100</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># organize by site and bind into an array</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(abind) <span class="co"># load abind package</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">abind</span>(data4d<span class="sc">$</span>y[<span class="fu">which</span>(data4d<span class="sc">$</span>site<span class="sc">==</span><span class="dv">1</span>),,],</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          data4d<span class="sc">$</span>y[<span class="fu">which</span>(data4d<span class="sc">$</span>site<span class="sc">==</span><span class="dv">2</span>),,], <span class="at">along =</span> <span class="dv">4</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># total augmented population size </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># augment site identifier</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>site <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">200</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">200</span>))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>s.st4d <span class="ot">=</span> <span class="fu">initialize_classic</span>(<span class="at">y=</span><span class="cn">NULL</span>, <span class="at">M=</span>M, <span class="at">X=</span>Xarray, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">site =</span> site, <span class="at">hab_mask =</span> hab_mask,<span class="at">all_random =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale inputs</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>rescale_list <span class="ot">=</span> <span class="fu">rescale_classic</span>(<span class="at">X =</span> Xarray, <span class="at">ext =</span> GridX<span class="sc">$</span>ext, <span class="at">s.st =</span> s.st4d, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">site =</span> site, <span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># store rescaled extent and convert to matrix</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>ext <span class="ot">=</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(rescale_list<span class="sc">$</span>ext, as.vector))</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data by summing over traps and occasions and add to list</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">apply</span>(y, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), sum),<span class="at">x_lower =</span> ext[,<span class="dv">1</span>],</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">x_upper =</span> ext[,<span class="dv">2</span>],<span class="at">y_lower =</span> ext[,<span class="dv">3</span>]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>            ,<span class="at">y_upper =</span> ext[,<span class="dv">4</span>],<span class="at">X =</span> rescale_list<span class="sc">$</span>X)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># add hab_mask, proportion of available habitat, and OK for habitat check</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>hab_mask <span class="ot">=</span> hab_mask</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co"># need to adjust proportion of habitat available</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>prop.habitat<span class="ot">=</span><span class="fu">apply</span>(hab_mask,<span class="dv">3</span>,mean) </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>OK <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>M)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare constants (note get density in activity center/100 m2)</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>constants <span class="ot">=</span> <span class="fu">list</span>(<span class="at">M =</span> M,<span class="at">J=</span><span class="fu">dim</span>(data4d<span class="sc">$</span>y)[<span class="dv">2</span>],</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a> <span class="at">K=</span><span class="fu">dim</span>(data4d<span class="sc">$</span>y)[<span class="dv">3</span>], <span class="at">sigma_upper =</span> <span class="dv">1000</span>, <span class="at">A =</span> (<span class="fu">sum</span>(hab_mask)<span class="sc">*</span>(pixelWidth<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="at">pixelWidth=</span>pixelWidth,<span class="at">nSites=</span><span class="fu">dim</span>(Xarray)[<span class="dv">3</span>],<span class="at">site =</span> site)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co"># add indexes for sites and individuals</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>site_indexL <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,M,<span class="dv">200</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>site_indexU <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">200</span>,M,<span class="dv">200</span>)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co"># priors for sigma: &#39;alpha&#39; and &#39;beta&#39; </span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>alpha <span class="ot">=</span> gparam<span class="sc">$</span>alpha</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>beta <span class="ot">=</span> gparam<span class="sc">$</span>beta</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co"># priors for lam0: &#39;alpha&#39; and &#39;beta&#39; </span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>alpha_lam0 <span class="ot">=</span> lam0_param<span class="sc">$</span>alpha</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>constants<span class="sc">$</span>beta_lam0 <span class="ot">=</span> lam0_param<span class="sc">$</span>beta</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>s.st <span class="ot">=</span> rescale_list<span class="sc">$</span>s.st</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="co"># define all initial values</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sigma =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">250</span>, <span class="dv">350</span>), <span class="at">su =</span> s.st,<span class="at">psi=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>),</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="at">lam0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>),<span class="at">pOK=</span>data<span class="sc">$</span>OK,<span class="at">zu=</span><span class="fu">rbinom</span>(constants<span class="sc">$</span>M,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>s.st <span class="ot">=</span> rescale_list<span class="sc">$</span>s.st</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co"># define all initial values</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sigma =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">250</span>, <span class="dv">350</span>), <span class="at">su =</span> s.st, <span class="at">psi=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>),</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a><span class="at">lam0 =</span> <span class="fu">runif</span>(<span class="fu">dim</span>(data<span class="sc">$</span>X)[<span class="dv">3</span>], <span class="fl">0.1</span>, <span class="fl">0.2</span>),</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="at">pOK=</span>data<span class="sc">$</span>OK,<span class="at">z=</span><span class="fu">rbinom</span>(M,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;psi&quot;</span>,<span class="st">&quot;lam0&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;su&quot;</span>,<span class="st">&quot;zu&quot;</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="co"># get model</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>sc_model <span class="ot">=</span> <span class="fu">get_unmarked</span>(<span class="at">occ_specific =</span> <span class="cn">FALSE</span>, <span class="at">hab_mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>                        <span class="at">trapsClustered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a><span class="co"># model code to replace old code</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>add_model <span class="ot">=</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>  lam0[g] <span class="sc">~</span> <span class="fu">dgamma</span>(alpha_lam0,<span class="dv">1</span><span class="sc">/</span>beta_lam0)</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dgamma</span>(alpha, <span class="dv">1</span><span class="sc">/</span>beta)</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a><span class="co"># now create new model</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>sc_model_inf <span class="ot">=</span> <span class="fu">customize_model</span>(sc_model, add_model, <span class="at">append_line =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>                               <span class="at">remove_line =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model (not run)</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="co"># sc_model_inf</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="co"># run model (need to set s_alias)</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> sc_model_inf, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, </span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a><span class="at">parallel=</span><span class="cn">TRUE</span>, <span class="at">RNGseed =</span> <span class="dv">500</span>, <span class="at">s_alias =</span> <span class="st">&quot;su&quot;</span>)</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 968.93 sec elapsed</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a><span class="co"># summary table of MCMC output (exclude &quot;su&quot; and &quot;zu&quot; parameters)</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a><span class="fu">nimSummary</span>(out, <span class="at">exclude_params =</span> <span class="fu">c</span>(<span class="st">&quot;su&quot;</span>,<span class="st">&quot;zu&quot;</span>))</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         post.mean post.sd    q2.5     q50   q97.5 f0    n.eff  Rhat</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D           0.102   0.022   0.066   0.099   0.152  1  270.831 1.008</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N         228.569  49.067 149.000 223.000 342.000  1  270.831 1.008</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lam0[1]     0.295   0.027   0.247   0.294   0.352  1 3595.823 1.002</span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lam0[2]     0.299   0.027   0.249   0.298   0.355  1 2805.852 1.001</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi         0.581   0.125   0.376   0.569   0.865  1  305.124 1.007</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma     295.497  27.822 243.024 295.005 352.028  1  319.216 1.002</span></span></code></pre></div>
<br>
<p>
These results are similar to our model run in part 4 with the
informative priors as expected. We again make a realized density surface
and note that the <code>realized_density()</code> function outputs a
list of length 2 in this example since we have 2 spatially separated
trapping grids here that are in a 3-dimensional array format.
</p>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate realized density surface (note setting z_alias and s_alias)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">realized_density</span>(<span class="at">samples=</span>out, <span class="at">grid=</span>GridX<span class="sc">$</span>grid, <span class="at">crs_=</span>mycrs,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">site=</span>constants<span class="sc">$</span>site, <span class="at">hab_mask=</span>hab_mask,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">z_alias =</span> <span class="st">&quot;zu&quot;</span>, <span class="at">s_alias =</span> <span class="st">&quot;su&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load needed packages for multiplot</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis) </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rasterVis)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raster from site 1</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">gplot</span>(r[[<span class="dv">1</span>]]) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_viridis</span>(<span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">name=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raster from site 2</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">gplot</span>(r[[<span class="dv">2</span>]]) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_viridis</span>(<span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">name=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange the two plots in a single row</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>prow <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>           p2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&#39;vh&#39;</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">nrow =</span> <span class="dv">1</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the legend from one of the plots</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>legend_t <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)))</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co"># add the legend above the row we made earlier. Give it 20% of the height</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co"># of one plot (via rel_heights).</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>pcomb <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(legend_t, prow, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(.<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co"># add x and y axis labels</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>pcomb <span class="ot">&lt;-</span><span class="fu">annotate_figure</span>(pcomb, <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Easting&quot;</span>, </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Northing&quot;</span>, <span class="at">rot=</span><span class="dv">90</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>pcomb</span></code></pre></div>
<br>
<p align="center">
<img src="data:image/png;base64,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" style="width:90%" />
</p>
<br>
<p>
Way to go! You’ve made it through the second ‘localSCR’ tutorial. Please
see Royle et al. (2014) for more details about spatial count theory and
modeling. The next tutorial will be similar but focused on spatial
mark-resight models that make inference to abundance/density for
marked/unmarked populations.
</p>
<p><br></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Chandler, R. B. 2018. Speeding up data augmentation in BUGS. <a href="https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE" class="uri">https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE</a>.</p>
<p>de Valpine P, C. Paciorek, D. Turek, N. Michaud, C. Anderson-Bergman,
F. Obermeyer, C. C. Wehrhahn, A. Rodrìguez, L. D. Temple, and S.
Paganin. 2022. <em>NIMBLE: MCMC, Particle Filtering, and Programmable
Hierarchical Modeling</em>. doi: 10.5281/zenodo.1211190 (URL: <a href="https://doi.org/10.5281/zenodo.1211190" class="uri">https://doi.org/10.5281/zenodo.1211190</a>), R package
version 0.12.2, URL:<a href="https://cran.r-project.org/package=nimble" class="uri">https://cran.r-project.org/package=nimble</a>.</p>
<p>Furnas, B. J., R. H. Landers, S. Hill, S. S. Itoga, and B. N. Sacks.
2018. Integrated modeling to estimate population size and composition of
mule deer. Journal of Wildlife Management 82:1429–1441.</p>
<p>Milleret, C., P. Dupont, C. Bonenfant, H. Henrik Brøseth, Ø.
Flagstad, C. Sutherland, and R. Bischof. 2019. A local evaluation of the
individual state‐space to scale up Bayesian spatial capture‐recapture.
Ecology a Evolution 9:352–363.</p>
<p>Turek, D., C. Milleret, T. Ergon, and H. Brøseth 2021. Efficient
estimation of large‐scale spatial capture–recapture model. Ecosphere <a href="DOI:10.1002/ecs2.338" class="uri">DOI:10.1002/ecs2.338</a>5.</p>
<p>Royle, J. A., R. B. Chandler, R. Sollmann, and B. Gardner. 2014.
Spatial capture‐recapture. Academic Press, Waltham, Massachusetts,
USA.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
