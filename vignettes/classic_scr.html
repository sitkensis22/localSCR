<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Daniel Eacker" />

<meta name="date" content="2022-04-22" />

<title>Classic SCR models: continuous state-space and marked individuals</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Classic SCR models: continuous state-space
and marked individuals</h1>
<h4 class="author">Daniel Eacker</h4>
<h4 class="date">2022-04-22</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>
The first vignette of the ‘localSCR’ package covers what I define as a
set of ‘classic’ Bayesian spatial capture-recapture (SCR) models (Royle
et al. 2014). These models are designed to model SCR data for ‘marked’
or ‘unmarked’ individuals under the assumption of uniformly distributed
activity centers (i.e,. a continuous state-space). Although many
distance detection functions are possible, the package currently
includes only a bivariate normal model of space use, which is commonly
employed in the literature. The package is meant to ease implementation
of Bayesian SCR models using the ‘nimble’ package (de Valpine et a.
2022), which allows for increased flexibilty with the ability for the
user to include custom functions and assign different algorithms to
specific model parameters. I took advantage of this functionality with
the goal of building a simple, straightforward workflow that was
flexible enough to handle most mainstream SCR analysis problems. Visit
<a href="https://r-nimble.org/download" class="uri">https://r-nimble.org/download</a> for information on
installing ‘nimble’ and Rtools on your computer.
</p>
<p><br></p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<p>
<p>The ‘localSCR’ package implements Bayesian SCR models using the
‘nimble’ package (de Valpine et a. 2022) following methods described in
Royle et al. (2014). We take advantage of recent developments in
computation of SCR models. In this tutorial, three methods are
implemented to decrease computational run time:</p>
<ol style="list-style-type: decimal">
<li>Block updating of x and y activity center coordinates (Turek et
al. 2021)</li>
<li>Using vectorized declarations for traps in distance function
calculations</li>
<li>Separating the data augmentation process into two steps (Chandler
2018)</li>
</ol>
<p>In some SCR problems, there are landscape features that create
‘unsuitable’ habitat for the study species. Habitat masks are used to
account for these features and designate suitable (1) or unsuitable (0)
habitat, and can be represented as a matrix or array of binary values.
We follow the methods of Milleret et al. (2019) to implement the “ones”
trick to account for habitat suitability. This restricts the possible
locations of latent activity centers to only suitable habitat. The
‘localSCR’ package provides functions to construct a habitat mask from
either raster or polygon data.</p>
Finally, in some SCR designs, clusters of trap arrays may be spread out
over the study area such that individuals can only be detected at one of
multiple trap arrays (e.g., Furnas et al. 2018). This necessitates
including the traps as a 3-dimensional array, using a site identifier to
track which site a detected or augmented individual belongs to, and
using a dynamic indexing in the model.
</p>
<br>
<p>
</div>
<div id="functions-used-from-localscr-package" class="section level2">
<h2>Functions used from ‘localSCR’ package:</h2>
<ul>
<li><code>get_classic()</code> grabs template model for given inputs
using the <code>nimbleCode()</code> function</li>
<li><code>grid_classic()</code> define state-space grid and extent</li>
<li><code>initialize_classic()</code> generate starting locations for
activity area centers</li>
<li><code>mask_polygon()</code> create habitat mask matrix or array from
polygon</li>
<li><code>nimSummary()</code> summarize lists of Markov Chain Monte
Carlo (MCMC) output</li>
<li><code>realized_density()</code> generate realized density surface
from MCMC output</li>
<li><code>rescale_classic()</code> rescale inputs to prepare data for
using habitat mask</li>
<li><code>run_classic()</code> wrapper function to run classic models
using ‘nimble’ package</li>
<li><code>sim_classic()</code> simulate basic spatial capture-recapture
data</li>
</ul>
</p>
<p><br></p>
</div>
<div id="turtorial" class="section level2">
<h2>Turtorial</h2>
<p>This tutorial includes four parts:</p>
<ol style="list-style-type: decimal">
<li>Create traps (or detectors) and then construct a state-space</li>
<li>Simulate ‘classic’ SCR data using state-space extent</li>
<li>Workflow for 2-D trap array including sex-specific scaling parameter
and habitat mask</li>
<li>Workflow for 3-D trap array including sex-specific scaling parameter
and habitat mask
</p>
<br>
<p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load &#39;localSCR&#39; package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(localSCR)</span></code></pre></div>
<p><br></p>
<div id="simulate-a-single-trap-array-with-random-positional-noise-and-create-state-space" class="section level3">
<h3>(1) Simulate a single trap array with random positional noise and
create state-space</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noise</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="dv">300</span> <span class="co"># simulate sigma of 300 m</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create state-space</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Grid <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> traps, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span>mysigma, <span class="at">res =</span> <span class="dv">100</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot of grid and trap locations</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Grid<span class="sc">$</span>grid),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(traps),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAApVBMVEUAAAAAADoAAGYAAP8AOpAAZrYzMzM6AAA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmtrZmtv9uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQkGaQ2/+ZmZmrbk2rbm6rbo6ryKur5P+2ZgC2tma225C2///Ijk3I///bkDrb/7bb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T////Gj0IRAAAN9klEQVR4nO3cDVvb1gGGYVp3bpwQtjSfdC1tyTacjY+Ca/3/nzbLhmADieS8ki1b9331iraQc3KQn8iyOXBQQOBg2wtgtwmIiICICIhIFpD8ek9ARAREREBEBEREQEQERERARAREREBEBEREQEQERKTBgH59/PEnfqvmH+vISMuomqy5gH799dH8T/xWzT/WkZGWUTWZK5BlZJO5ByIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiYkeiZUST2RNtGfZEtzfSMqomcw9EREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERMSORMuIJrMn2jLsiW5vpGVUTeYeiIiAiAiIiICICIiIgIgIiIiAiAiISFUC16/HRTF5Nzq8eHioM5q9V5HA1ejFuJieHBfnLx8c6oxm/309gbPnf8yuQJMP4/JKtHqoMZoeqPMUdv3mopi8P109FMVwOBRQ79UJ6OpwnszqodZo9l5wBaoxmr1XJyD3QHxRnYCmJ28XL7+WD7VGs/cafB+ouzvp9nIrYEeWYU+0ZdgT3d5Iy6iazNfCiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIjYkWgZ0WT2RFuGPdHtjbSMqsncAxEREBEBEREQEQERERCRHQloMBhs6q9iLbsR0GCgoI4SEBEBEdmNgNwDddaOBNRVwhZQottPrRtZWw8DavC8djqgzSyufwE1eV4bfYyafrgF1I6uPuiNP94CakdXn3aaX9eu3QN1dyfd6u8tzuvWl/Hwtz4H1N3zaE90p5dx189OnY0+XoEso8nJ+ncPRKMERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jGgye6Itw57o9kZaRtVk7oGICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiNiRaBnRZPZEW4Y90e2NtIyqydwDEREQEQERERARAREREBEBEREQEQERqZXA+Wg0ejEuJu9GhxfF3aH2aPZZrQTOjstfpyfHxfnLu0P90eyzOglMfzstD5MP4+L69fj2UHs0e61OArPnrNHouLh+c1FM3p/eHopiOBwKqPfqJHD902l5Fbo6nJdze6g9mr1WO4Gz44dXoHVGs6/WCMg9EI/VSaB80pr+Pp6evF28CnvrVRh36r4P9Py0qHofqLs76fZyK2BHlmFPtGXYE93eSMuomszXwogIiIiAiAiIiICICIiIgIgIqDMGg8G2l/ANBNQVg8FOFtSzgDr8GAloB3T5Qery2r5CQJ3R8NI29JnuSkDNnI5OB9SsTX2qOxJQU6ej6ZPa3R4FtKKjl46OLqskoBUdfaQ6uqw590AruvlAdTmgDbEjMZrstp9tL2NDI+2Jtoyml+EKZBnZZLtyD0RHCYiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiC2tlhFNZlO9ZdhU395Iy6iazD0QEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jmsyeaMtoaE/0zdHBnVeP/9zTXIF6v4ylBC4Pns1/fXVz9OyJP/kU90C9d5/AXz//bX789MP/Zv+tO5qeWn4KWzxzXX7/n9l/646mp5avQIsnrvIKJCBqeuoe6O7JbK3R9NNyAvPXYbOLz8e6FyAB4Z1oIgIispTAXz8v3kas/QQmIJYTqH/r89Ro+mn5faC67z8/NZqeevxG4reNpqcefynj20bTUytvJK59CRJQ7z2xncOrMOrzPhARARGxJ9oyosluE7g5epbeA3V3L+9ebkbuyDJcgSwjm8w9EBFfTCXii6lEfDGViC+mEvHFVCJLCfz5oy+msq7PbyR+/sZ4r8L2wGAw2NDf5H2gfTQYbKygpZvov/8yP1Z+X/Pk3ejw4uHoHbK5f51bs9WAqr6veXpyXJy/fDh6d2zw5G7NFgL6eH8PVPF20OTDuLh+PV4ZvUs6HVBTS9vGPdDdFajK9ZuLYvL+tCiGw+EGAmr8VDQXUPOPUqfjftrjn85R5erwNqBiE1egFk5pg/10N+6NWf+d6M9XoGJHA2qKgErL35VR7w2gzd4DdfiUtrG0zn6yX7T+d2VMT95u8lVYh09ph5e2Od+QwJfeB+ruTrq93ArYkWX4OdGW0die6D9/nD2BfVfvxfzj0R3+l7OX//Q7soxHPyPx0zrf4LyLbyTSqCd/Sus3jKannvw50d8wmp5yBSLiHohIg6/C6CM7EokIiIhN9UQeJfCxakfiV0fTNw8SmF2J1vnmMAH13moCl+s8fz0aTQ+tJPDpYI03ER+Npo9Wfz7Quj+fQ0C9t7Ij0ffGs67PCax7+7M6mr66S+DTwfo/3EVANPlGYnd30u3lVsCOLMOeaMtobE/0+lyBer8MX0wlIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICImJHomVEk9kTbRn2RLc30jKqJnMPRERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBETEjkTLiCazJ9oy7Ilub6RlVE3mHoiIgIgIiIiAiAiIiICICIhIHwMaDAbbXsL+2JWAGnzQB4NOFtTJRVXbkYCafNCbmqvZR7yjWVcS0JanaWe6zcXYw4AaOrtdDmiDl7MdCaiDdwhNP0gNX4AE1Hnda/ozAZFxD8SOEBAROxItI5rMnmjLsCe6vZGWUTWZeyAiAiIiICICIiIgIgIiIiAiAiIiICK1EjgfjUYvxsXk3ejworg71B7NPquVwNlx+ev05Lg4f3l3qD+afVYngelvp+Vh8mFcXL8e3x5qj2av1Ulg9pw1Gh0X128uisn709tDUQyHQwH1Xp0Ern86La9CV4fzcm4PtUez16oSOBuNFvc7Z8cPr0A1RrP3aidwduweiMfqJFA+aU1/H09P3i5ehb31Kow7dd8Hen5aVL0P1N2ddHu5FbAjy7An2jLsiW5vpGVUTeZrYUQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBE7Ei0jGgye6Itw57o9kZaRtVk7oGICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiNiRaBnRZPZEW4Y90e2NtIyqydwDEREQEQERERARAREREBEB7a/BYND+X7IrAW3kZGxT85/gYLCJk7YjAW3mZGxRC5+ggJY0dDLaeJAam0hALWrmZDR+SpubsI1H2z3QkqYuQF0NaGdv8nYloEZ0OaBd1auAOnwPtLP6FRCNExARARGxI9EyosnsibYMe6LbG2kZVZO5ByIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiYkeiZUST2RNtGfZEtzfSMqomcw9EREBEBEREQEQERERARAREREBEBESkKoHr1+OimLwbHV48PNQZzd6rSOBq9GJcTE+Oi/OXDw51RrP/vp7A2fM/ZlegyYdxeSVaPdQYTQ/UeQq7fnNRTN6frh6KYjgcCqj36gR0dThPZvVQazR774sJnI1G5Y3OV65AXxtNX9S5ArkH4ovqBDQ9ebt4+bV8qDWavdfg+0Dd3Um3l1sBO7IMe6Itw57o9kZaRtVkvhZGREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERMSORMuIJrMn2jLsiW5vpGVUTeYeiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIHYmWEU1mT7Rl2BPd3kjLqJrMPRARAREREBEBEREQEQERERARAREREBEBEREQEQERCQNKDeMZtjt/nz+BJgKKDXd8fp+AgLr9F3T+E3AXQ0RARAREREBEthPQ9etxUUzejQ4vHh4acj4ajV6M25n7Xlvztr78Bs//VgK6Ks/O9OS4OH/54NCUs+Py13bm/qyteVtffpPnfxsBnT3/Y/YvYPJhXP5LWD009DdMfzstD63Mfa+tedtefqPnf3tPYddvLorJ+9PVQ0Pzz67Ho9Fx0crc99qat/3lN3j+txfQ1eF8yauHpub/6bT8Z9zK3Pfamrf95Td4/jcc0NloVD7RtnkFuv0ryhuJXb0CzbW5/L24ArV5DzR3dryr90BzbS6/wfO/vYCmJ28Xt//Lh4aUF+Tp7+NW5r7X1rztL7/B87+/7wM9P21p7nttvg/U6vJ3/X0g9oeAiAiIiICICIiIgIgIqMrH229C+OF/jz92+aq4OXq1+TV1iICqfHyqnIW+x1MSUBUBfZWAqiwHVD6dlc38+WP5P8pff/jvUfk09o+jxQdmf+C7f373y9YWu3kCqrIU0Me/FcWnWR5//jiL5fLg1c3R4h7o5mj2m+UHPn7/n9nvC4gldzfRz4qbv/9SzOO5nHVSug/o2fwD87CKjwJiyeo90GX5VHVztCjoPqBX8/+zCOtSQCxZCujTwcH3/y6vMn/9fLAIaTWgTwLikfuA5s9Qi6epYv5M5QokoGr3Ac37uDy4DWgWzMOAFnF9EhBLVq9AN0ezu+n5NeayvAI9WwnIqzAeu3sVVr5SL38tX2RdLv7/7GO37wPdBlT+4e//dfsarR8E1LhLAfFt5vdA8zeF+kNATSqf2g769fUxAREREBEBEREQEQER+T9vCRW+Oh5tcwAAAABJRU5ErkJggg==" style="width:70%" />
</p>
<p>
<p><br> Here, we can see the state-space grid that was created from
<code>grid_classic()</code>. Also, the traps (or detectors) are plotted
over top in blue. We arbitrarily chose a grid resolution of 100 in this
example (i.g., <code>res = 100</code>), but this will vary by problem.
In most situations, it is prudent to test the effect of different grid
resolutions on the estimated abundance and density in SCR models (see
Royle et al. 2014). Also, note the use to the EPSG code to define the
coordinate reference system for our state-space (see <a href="https://epsg.io/32608" class="uri">https://epsg.io/32608</a>).</p>
Now lets simulate some spatial capture-recapture data using
<code>sim_classic()</code>. Note for this example, we will simulate a
‘true’ population size of 200 individuals (<code>N = 200</code>), 4
sampling occasions (<code>K = 4</code>), a scaling parameter
(<code>sigma_</code>) of 300 m, a baseline encounter probability of 0.10
(<code>base_encounter = 0.10</code>), no sex-specificity
(<code>prop_sex = 1</code>), and no habitat mask
(<code>hab_mask = FALSE</code>). We also use <code>setSeed = 100</code>
to make the simulation reproducible. We provide the function the extent
of the state-space output from <code>grid_classic()</code> as
<code>ext = Grid$ext</code>. Note that Grid is a list.
</p>
<p><br></p>
</div>
<div id="simulate-scr-data-and-make-a-plot-of-it." class="section level3">
<h3>(2) Simulate SCR data and make a plot of it.</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate SCR data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data3d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sigma_ =</span> mysigma, <span class="at">prop_sex =</span> <span class="dv">1</span>,<span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">base_encounter =</span> <span class="fl">0.10</span>, <span class="at">enc_dist =</span> <span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">hab_mask =</span> <span class="cn">FALSE</span>, <span class="at">setSeed =</span> <span class="dv">100</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect simulated data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data3d)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ y  : int [1:200, 1:25, 1:4] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sex: int [1:200] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ s  : num [1:200, 1:2] -658 -830 182 -1521 -106 ...</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;sx&quot; &quot;sy&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># bind simulated activity centers with vector of the number of individual detections</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>sdata <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(data3d<span class="sc">$</span>s,<span class="at">Ndet=</span><span class="fu">apply</span>(data3d<span class="sc">$</span>y,<span class="dv">1</span>,sum)))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Grid<span class="sc">$</span>grid),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span> </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(traps),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>sdata,<span class="fu">aes</span>(<span class="at">x=</span>sx,<span class="at">y=</span>sy,<span class="at">size=</span>Ndet),<span class="at">color=</span><span class="st">&quot;orangered&quot;</span>,<span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>)) <span class="sc">+</span> </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
<p>In the plot we can see the point sizes are relative to the number of
detections (‘Ndet’) for each simulated individual. Although most
individuals detected near or on the grid have a large number of
detections, we still pick up some individuals multiple times on the edge
of the grid just by chance. Also, the point pattern appears random
because we are drawing simulated activity center coordinates using
<code>runif()</code>, which adheres to our assumption of a random
distribution of individual activity centers across the state-space in
our classic SCR analysis.</p>
<p>Next, we’ll create the same trap array but we’ll set a sex-specific
scaling parameter (<code>sigma_</code>) of 220 m and 300 m, which could
represent a smaller female and larger male activity area sizes
respectively. In order to fully specify a sex-specific scaling parameter
in <code>sim_classic()</code>, we need to set
<code>0 &gt; prop_sex &lt; 1</code>, otherwise the simulation will only
use a single scaling parameter. In the example, we also specify
<code>enc_dist = &quot;binomial</code> to use a binomial encounter
distribution; the other available option is the Poisson distribution
(<code>enc_dist = &quot;poisson</code>).</p>
<p>We add on an additional layer of complexity by introducing a habitat
mask. After constructing a polygon feature using the ‘sf’ package, we
then use the function <code>mask_polygon()</code> to build a habitat
mask as a matrix object. The habitat matrix is either ‘0’ (unsuitable)
or ‘1’ (suitable). In the habitat matrix the rows represent the
y-coordinate (“Northing”) of the state-space grid and the columns
represent the x-coordinate (“Easting”) of the state-space grid. We’ll
use this habitat matrix as data below in this part of the tutorial.</p>
We also see the use of <code>initialize_classic()</code>, which
generates plausible starting activity center locations for all
individuals. Note that for detected individuals, the function uses the
mean capture location as the starting location while random locations
are used for augmented individuals. Given our simulated population size
of 200, we specify the total augmented population size (detected +
augmented individuals) at 400 (<code>M = 400</code>).
</p>
<p><br></p>
</div>
<div id="workflow-for-simple-scr-model-with-sex-specific-sigma-binomial-encounter-distribution-and-habitat-mask" class="section level3">
<h3>(3) Workflow for simple SCR model with sex-specific sigma, binomial
encounter distribution, and habitat mask</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noise</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">300</span>) <span class="co"># simulate sex-specific</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>pixelWidth <span class="ot">=</span> <span class="dv">100</span> <span class="co"># store pixelWidth or grid resolution</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create state-space grid and extent</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>Grid <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> traps, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), <span class="at">res =</span> pixelWidth) </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create polygon for mask</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>poly <span class="ot">=</span> <span class="fu">st_sfc</span>(<span class="fu">st_polygon</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1765</span>,<span class="sc">-</span><span class="dv">1765</span>,<span class="dv">1730</span>,<span class="sc">-</span><span class="dv">1650</span>,<span class="dv">1600</span>,<span class="dv">1650</span>,<span class="dv">0</span>,<span class="dv">1350</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="dv">800</span>,<span class="dv">1700</span>,<span class="sc">-</span><span class="dv">1850</span>,<span class="dv">1000</span>,<span class="sc">-</span><span class="dv">1765</span>,<span class="sc">-</span><span class="dv">1765</span>),<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))), <span class="at">crs =</span>  mycrs)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># create habitat mask</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>hab_mask <span class="ot">=</span> <span class="fu">mask_polygon</span>(<span class="at">poly =</span> poly, <span class="at">grid =</span> Grid<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">prev_mask =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for uniform state-space and habitat mask</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>data3d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs, <span class="at">sigma_ =</span> mysigma, <span class="at">prop_sex =</span> <span class="fl">0.7</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>, <span class="at">base_encounter =</span> <span class="fl">0.15</span>, <span class="at">enc_dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">hab_mask =</span> hab_mask, <span class="at">setSeed =</span> <span class="dv">100</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># total augmented population size </span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>s.st3d <span class="ot">=</span> <span class="fu">initialize_classic</span>(<span class="at">y=</span>data3d<span class="sc">$</span>y, <span class="at">M=</span>M, <span class="at">X=</span>traps, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                            <span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># bind simulated activity centers with vector of either 1 (detected) or 0 (not detected)</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>s.stdata <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(s.st3d,<span class="at">Det=</span><span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">apply</span>(data3d<span class="sc">$</span>y,<span class="dv">1</span>,sum)<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">0</span>,M<span class="sc">-</span><span class="fu">nrow</span>(data3d<span class="sc">$</span>y)))))</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Det to factor</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>s.stdata<span class="sc">$</span>Det <span class="ot">=</span> <span class="fu">as.factor</span>(s.stdata<span class="sc">$</span>Det)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co"># make 1 as the baseline level for plotting</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>s.stdata<span class="sc">$</span>Det <span class="ot">=</span> <span class="fu">factor</span>(s.stdata<span class="sc">$</span>Det, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;0&quot;</span>))</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Grid<span class="sc">$</span>grid),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(traps),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>s.stdata,<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2,<span class="at">fill=</span>Det,<span class="at">color=</span>Det),<span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>s.stdata[s.stdata<span class="sc">$</span>Det<span class="sc">==</span><span class="dv">1</span>,],<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">color=</span><span class="st">&quot;lawngreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>poly, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">datum=</span><span class="fu">st_crs</span>(mycrs)) <span class="sc">+</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span> </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lawngreen&quot;</span>,<span class="st">&quot;orangered&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.025</span>)) <span class="sc">+</span> </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAw1BMVEUAAAAAADoAAGYAAP8AOpAAZrYzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshZWVlmAABmADpmOpBmtrZmtv9uTW5uTY5ubqtuq+R8/ACOTU2OTW6OTY6OyP+QOgCQkGaQ2/+ZmZmrbk2rbm6rbo6ryKur5P+2ZgC2Zjq2tma2tv+225C2///Ijk3I///bkDrbkGbb/7bb///kq27k////RQD/tmb/yI7/25D/5Kv//7b//8j//9v//+T////rp+hyAAAgAElEQVR4nO2di5bcNnKGsdbuOIlaVlqbyCsp9jiWbI9y2RklsXp0GQ/f/6nSvOOOKqBAoNj4j46a02QBBeAjAKLIpuiamhIkSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JUo70MRborQDTbwlSjvQxFuitANNvCVKO9DEW6K0A028JQpaN+1AoqB10w4kClo37UCioHXTDiQKWjftQKKgddMOJApaN+1AoqB10w4kClo37UCioHXTDiQKWmfQ6VTag0uTKGhNquOxx6dXaU8uS6KgNaF6fI7HBtD2EgWt6XQc/j9NCBV25rIkslq/fWvfdu6IMjiO/PQj2IBQVA753CMxyJMbgURO67dvV2/lbeeOKIPjsn0aEDrG5JDPPRKDPLlRSOS03qLC5+5nBujcAfVf1dFCDaBE6/yd8FH9fhq/zgjVMUZUNYSNnTOnISy71u7H3OPctQOhLxSOx6FCMtSJKGidLH997BYh1GrFcWJnoK4BJCsMyE4RggK0oLMYNYAkeSpjrd09InQ6hQlS2FmtGkCLPGSo1bu/yVAAIJOd1ehIv8gqClonyAeFUb17Q8jFz9HOjmTTABrlJcJ2gu4LIQtAHnRkozaEDQLU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" style="width:70%" />
</p>
<br>
<p>
<p>In the figure above we can see the effect of the polygon in creating
a habitat mask for the state-space. The
<code>initialize_classic()</code> function contains the initial activity
center locations to within the polygon (note that points on the edges
were in suitable habitat when the continuous locations were discretized
and checked with the habitat mask).</p>
We now have most of the components we will need to analyze the simulated
data set. However, because we are using a habitat mask in the model
(<code>hab_mask</code>), we first must rescale the traps, grid extent,
and initial activity center locations.
</p>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale inputs</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rescale_list <span class="ot">=</span> <span class="fu">rescale_classic</span>(<span class="at">X =</span> traps, <span class="at">ext =</span> Grid<span class="sc">$</span>ext, <span class="at">s.st =</span> s.st3d, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># store rescaled extent</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ext <span class="ot">=</span> rescale_list<span class="sc">$</span>ext</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span>data3d<span class="sc">$</span>y)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">=</span> data<span class="sc">$</span>y[<span class="fu">which</span>(<span class="fu">apply</span>(data<span class="sc">$</span>y, <span class="dv">1</span>, sum)<span class="sc">!=</span><span class="dv">0</span>),,] <span class="co"># remove augmented records </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">=</span> <span class="fu">apply</span>(data<span class="sc">$</span>y, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), sum) <span class="co"># covert to 2d by summing over individuals and traps</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add rescaled traps</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>X <span class="ot">=</span> rescale_list<span class="sc">$</span>X</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare constants (note get density in activity center/100 m2 rather than activity centers/m2)</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>constants <span class="ot">=</span> <span class="fu">list</span>(<span class="at">M =</span> M,<span class="at">n0 =</span> <span class="fu">nrow</span>(data<span class="sc">$</span>y),<span class="at">J=</span><span class="fu">dim</span>(data<span class="sc">$</span>y)[<span class="dv">2</span>], <span class="at">K=</span><span class="fu">dim</span>(data3d<span class="sc">$</span>y)[<span class="dv">3</span>],</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="at">x_lower =</span> ext[<span class="dv">1</span>], <span class="at">x_upper =</span> ext[<span class="dv">2</span>], <span class="at">y_lower =</span> ext[<span class="dv">3</span>], <span class="at">y_upper =</span> ext[<span class="dv">4</span>],</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="at">sigma_upper =</span> <span class="dv">1000</span>, <span class="at">A =</span> (<span class="fu">sum</span>(hab_mask)<span class="sc">*</span>(pixelWidth<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),<span class="at">pixelWidth=</span>pixelWidth)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># augment sex</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>sex <span class="ot">=</span> <span class="fu">c</span>(data3d<span class="sc">$</span>sex,<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>M<span class="sc">-</span><span class="fu">length</span>(data3d<span class="sc">$</span>sex)))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># add z and zeros vector data for latent inclusion indicator</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>z <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>n0),<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>M <span class="sc">-</span> constants<span class="sc">$</span>n0))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>zeros <span class="ot">=</span>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>n0),<span class="fu">rep</span>(<span class="dv">0</span>,constants<span class="sc">$</span>M <span class="sc">-</span> constants<span class="sc">$</span>n0))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add hab_mask and OK for habitat check</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>hab_mask <span class="ot">=</span> hab_mask</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>OK <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>M)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>s.st3d <span class="ot">=</span> rescale_list<span class="sc">$</span>s.st</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co"># define all initial values</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sigma =</span> <span class="fu">runif</span>(<span class="dv">2</span>, <span class="dv">250</span>, <span class="dv">350</span>), <span class="at">s =</span> s.st3d,<span class="at">psi=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="at">p0 =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span>),<span class="at">pOK=</span>data<span class="sc">$</span>OK,<span class="at">z=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>n0),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">0</span>,constants<span class="sc">$</span>M<span class="sc">-</span>constants<span class="sc">$</span>n0)))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;psi&quot;</span>,<span class="st">&quot;p0&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;psi_sex&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;z&quot;</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co"># get model</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>scr_model <span class="ot">=</span> <span class="fu">get_classic</span>(<span class="at">dim_y =</span> <span class="dv">2</span>, <span class="at">enc_dist =</span> <span class="st">&quot;binomial&quot;</span>,<span class="at">sex_sigma =</span> <span class="cn">TRUE</span>,<span class="at">hab_mask=</span><span class="cn">TRUE</span>,</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="at">trapsClustered=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> scr_model, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>, </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="at">RNGseed =</span> <span class="dv">500</span>)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 106.658 sec elapsed</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize output</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">do.call</span>(rbind, out)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples[,<span class="fu">which</span>(<span class="fu">dimnames</span>(out[[<span class="dv">1</span>]])[[<span class="dv">2</span>]]<span class="sc">==</span><span class="st">&quot;N&quot;</span>)], <span class="at">xlab =</span> <span class="st">&quot;Abundance&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">500</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">200</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># add line for simulated abundance</span></span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmZjpmkJBmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC225C2///T09PbkDrb2//b////AAD/tmb/25D//7b//9v///8GwFRaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAP80lEQVR4nO3d63rbxmKGUTmW0lbe7Y5bs6nqULLu/yY3AQwPokJJmG8gAuRaP3IQnHko8A0IDMnBzTMEbs79AFg2AREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQEVf537ASyUgAoB1RFQIaA6AioEVEdAhYDqCKgQUB0BFQKqI6BCQHUEVAiojoAKAdURUCGgOgIqBFRHQIWA6gioEFAdARUCqnOtAd3slB8IqM7VBvR/hYAyAio/EFAdAZUfCKjOtQW0O/URUBtXF9C2GwG1IaCyQUB1BFQ2CKiOgMoGAdURUNkgoDoCKhsEVEdAZYOA6giobBBQHQGVDQKqI6CyQUB1BFQ2CKiOgMoGAdURUNkgoDoCKhsEVEdAZYOA6giobBBQHQGVDQKqMy6gX9+Hj/P99udED2dyAmpsVEAPN/fDP6y3/7A4AmpsTEC/vu+yefj6c4IH8wkE1NiYgJ6+/bH9x/VSX8QE1JgjUNkgoDojz4HKIcg5EMW4q7Cnb8NV2FKPPwJqzjxQ2SCgOgIqGwRUx0Ri2SCgOiYSywYB1XEZXzYIqI6JxLJBQHUcgcoGAdUxkVg2CKiOicSyQUB1zAOVDQKq0yagV4vmzpaAGms8kSiga9N4IlFA16bxZbyArk3jiUQBXRtHoLJBQHUaTyQK6No0nkgU0LVp/IwL6NoIqGwQUJ2KZ3x9c/PlR7vhPpeAGhv3jK9ubu4f/+Pn4QV9MtwZCKixUc/4anPyvOqPPi7j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4aD9EK1fwoaR7/6Y70tY05Po521ALc9Ny/3Pmp9E989Ly/PdsgZL00GHB/p7egmxmMv4ElDLC9ntvWNajjk8C+u2cwO9VdvL+FYPdDkTieXg2m4q7fFue8uhlnN+u+e58UTiMBPdcNC+lFX8QCd9K2M3q99EeXXeDZqOXl4YujGajbmx6l5rmj7QMm7/VkbDQds8UG+mEhEQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQEREdBLq8MVX05quGTE0gnohcff/7NfwkFAHyWgFx5++98+HQF9lIAO/fp+2y3R2wX0X3f9WplP3/7o//L07Z/fhtVQujVQ/qcLqCyP8mJLv/L7w3YB/GsgoEPdkaVbo3cTULdS7939QUBl06pbib5bRqdboKn7wW7L8C/3wyK/d9dSkIAOdYs49WvNDwE8/PbnPqD7g6UPV19+PP3jx/BKt93S//25rFXfcG3RmRPQgSGb7hhTVhDcdLILaPj7fp29535F6D92x6jtadOw7Z2TqMshoAO71VDLerqbvx4H9LALaPOH+zPuXUDl5iXr3SBXQUB7w/nzJobbDxyB+j/xeHfqCHQ1BLS3feofujz6c6CvP/dnOIeZbP7EsG7+wUvY/hzoSo49AwHtDeug9qdC/VVYl0d314Jf3292AfXXWN1V2HDwudlfp/VbuoNYfxm3upbjkIB29ue9q83JTTcP1P17d2O/f+5fwvbzQP2auKv9i9zLeaBruQgTEBkBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARARH5FxXmj1gbwCbiAAAAAElFTkSuQmCC" style="width:70%" />
</p>
<br>
<p>
<p>We can see from the histogram of the posterior samples of
<code>N</code> that our model estimates were close to the simulated
value of 200 individuals (shown by red line) and were biased slightly
low at around 186 individuals. This is expected since this is only one
realization of the detection process. In this example, we divided the
pixelWidth by 100 in deriving the area (<code>A</code>) in our list of
constants. This allowed us to estimate density in activity centers/100
m<sup>2</sup> rather than activity centers/m<sup>2</sup>. Note that care
must be taken with any rescaling of the data or constants.</p>
Next we use<code>nimSummary()</code> to quickly summarize the MCMC
samples. Note that there are other options to summarize MCMC output, but
this function is provided with the package and depends partly on the
‘coda’ package. Then, we make a realized density plot of the MCMC
samples using <code>realized_density()</code>. In this function we make
use of the list of grid and extent we created earlier called
<code>Grid</code> as well as our saved coordinates reference system
(<code>mycrs</code>). In this example, we use the ‘raster’ package to
make a simple plot of the output. We can see that the habitat mask has
resulted in some cells having <code>NA</code> values where the habitat
was unsuitable.
</p>
<p><br></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize MCMC samples (exclude parameters and don&#39;t plot)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nimSummary</span>(out, <span class="at">exclude_params =</span> <span class="fu">c</span>(<span class="st">&quot;s&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          post.mean post.sd    q2.5     q50   q97.5 f0   n.eff  Rhat</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D            0.217   0.027   0.174   0.214   0.279  1 287.723 1.003</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N          232.708  28.761 186.000 229.000 298.000  1 287.723 1.003</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p0           0.133   0.024   0.091   0.131   0.183  1 405.761 1.012</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi          0.581   0.076   0.456   0.574   0.749  1 298.192 1.003</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi_sex      0.758   0.054   0.648   0.761   0.855  1 465.875 1.003</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[1]   306.583  45.277 236.604 299.853 411.239  1 254.652 1.000</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[2]   278.029  25.147 232.727 276.585 331.032  1 273.259 1.011</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make realized density plot </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">realized_density</span>(<span class="at">samples =</span> out, <span class="at">grid =</span> Grid<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">site =</span> <span class="cn">NULL</span>, <span class="at">hab_mask =</span> hab_mask)       </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># load virdiis color palette and raster libraries      </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># make simple raster plot</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">100</span>),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">expression</span>(<span class="st">&quot;Realized density (activity centers/100 m&quot;</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Northing&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Easting&quot;</span>)</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
Next we repeat a similar workflow but now we have two trap arrays that
are clustered in space, and thus, there is a negligble chance of
detecting an individual at more than one trap array. In this case, the
functions in ‘localSCR’ can automatically detect that the traps are in a
3-dimensional format and we note that <code>sim_classic</code> will
return a variable called <code>site</code> that identifies which trap
array that each individual (both detected and not detected) belongs to.
Note that the number of rows in the simulated data <code>y</code> will
equal the simulated population size (here in the example,
<code>N = 200</code>). However, because we are using a trick provided by
Chandler (2018) to separate the data augmentation process into two
steps, we only need the encounter data for those individuals that were
detected in the model likelihood. Also, because we have no
occasion-specific detection covariates, we can sum <code>y</code> over
individuals and traps to result in a 2-dimensional encounter history
array (i.e., <code>y[i,j]</code>). This speeds us the model under these
conditions and we can specify this when we get the SCR model template by
setting <code>y_dim = 2</code> in
<code>get_classic(y_dim = 2,...)</code>. Otherwise, the workflow is very
similar to having a 2-dimensional trap array in the previous example.
</p>
<p><br></p>
</div>
<div id="workflow-for-simple-scr-model-with-sex-specific-sigma-binomial-encounter-distribution-and-habitat-mask-using-a-3d-trap-array-or-clustered-traps." class="section level3">
<h3>(4) Workflow for simple SCR model with sex-specific sigma, binomial
encounter distribution, and habitat mask using a 3D trap array or
clustered traps.</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a single trap array with random positional noise</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">800</span>, <span class="dv">800</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>traps <span class="ot">&lt;-</span> traps <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">prod</span>(<span class="fu">dim</span>(traps)),<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>) <span class="co"># add some random noise to locations</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>mysigma <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">300</span>) <span class="co"># simulate sex-specific</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>mycrs <span class="ot">=</span> <span class="dv">32608</span> <span class="co"># EPSG for WGS 84 / UTM zone 8N</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>pixelWidth <span class="ot">=</span> <span class="dv">100</span> <span class="co"># store pixelWidth</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create an array of traps, as an approach where individuals will only be detected </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># at one of the trap arrays (e.g., Furnas et al. 2018)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>Xarray <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(traps),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>Xarray[,,<span class="dv">1</span>]<span class="ot">=</span>traps</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>Xarray[,,<span class="dv">2</span>]<span class="ot">=</span>traps<span class="sc">+</span><span class="dv">4000</span> <span class="co"># shift trapping grid to new locations</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create grid and extent for 3D trap array</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>GridX <span class="ot">=</span> <span class="fu">grid_classic</span>(<span class="at">X =</span> Xarray, <span class="at">crs_ =</span> mycrs, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), <span class="at">res =</span> <span class="dv">100</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create polygon to use as a mask</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>poly <span class="ot">=</span> <span class="fu">st_sfc</span>(<span class="fu">st_polygon</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1660</span>,<span class="sc">-</span><span class="dv">1900</span>,<span class="dv">5730</span>,<span class="sc">-</span><span class="dv">1050</span>,<span class="dv">5470</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dv">5650</span>,<span class="dv">0</span>,<span class="dv">6050</span>,<span class="sc">-</span><span class="dv">1800</span>,<span class="dv">5700</span>,<span class="sc">-</span><span class="dv">1660</span>,<span class="sc">-</span><span class="dv">1900</span>),<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>))), <span class="at">crs =</span>  mycrs)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># make ggplot</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(GridX<span class="sc">$</span>grid[,,<span class="dv">1</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,<span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Xarray[,,<span class="dv">1</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(GridX<span class="sc">$</span>grid[,,<span class="dv">2</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;grey60&quot;</span>,<span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(Xarray[,,<span class="dv">2</span>]),<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>poly, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">datum=</span><span class="fu">st_crs</span>(mycrs)) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Easting&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2000</span>,<span class="dv">6000</span>)) <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2000</span>,<span class="dv">6000</span>)) <span class="sc">+</span> </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
In the figure we can see our two spatially separated trapping grids and
that the polgon overlaps some of the gridded area. The area outside the
polygon will be considered unsuitable when the habitat matrix is
created. Note that the <code>site</code> variable will be only as long
as the simulated population size (here, 200) and thus, we will need to
augment the variable to have the length equal to the total augmented
population size (i.e., <code>M = 400</code>). Otherwise the workflow is
very similar to the previous one.
</p>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get 3D habitat mask array for 3D grid</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>hab_mask <span class="ot">=</span> <span class="fu">mask_polygon</span>(<span class="at">poly =</span> poly, <span class="at">grid =</span> GridX<span class="sc">$</span>grid, <span class="at">crs_ =</span> mycrs, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">prev_mask =</span> <span class="cn">NULL</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for uniform state-space and habitat mask (N is simulated abundance)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>data4d <span class="ot">=</span> <span class="fu">sim_classic</span>(<span class="at">X =</span> Xarray, <span class="at">ext =</span> GridX<span class="sc">$</span>ext, <span class="at">crs_ =</span> mycrs, <span class="at">sigma_ =</span> mysigma, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">prop_sex =</span> <span class="fl">0.7</span>,<span class="at">N =</span> <span class="dv">200</span>, <span class="at">K =</span> <span class="dv">4</span>, <span class="at">base_encounter =</span> <span class="fl">0.15</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">enc_dist =</span> <span class="st">&quot;binomial&quot;</span>,<span class="at">hab_mask =</span> hab_mask, <span class="at">setSeed =</span> <span class="dv">500</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># total augmented population size </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># augment site identifier</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>site <span class="ot">=</span> <span class="fu">c</span>(data4d<span class="sc">$</span>site,<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,((M<span class="sc">-</span><span class="fu">length</span>(data4d<span class="sc">$</span>site))<span class="sc">/</span><span class="dv">2</span>)),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="dv">2</span>,((M<span class="sc">-</span><span class="fu">length</span>(data4d<span class="sc">$</span>site))<span class="sc">/</span><span class="dv">2</span>))))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values </span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>s.st4d <span class="ot">=</span> <span class="fu">initialize_classic</span>(<span class="at">y=</span>data4d<span class="sc">$</span>y, <span class="at">M=</span>M, <span class="at">X=</span>Xarray, <span class="at">buff =</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">max</span>(mysigma), </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">site =</span> site, <span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale inputs</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>rescale_list <span class="ot">=</span> <span class="fu">rescale_classic</span>(<span class="at">X =</span> Xarray, <span class="at">ext =</span> GridX<span class="sc">$</span>ext, <span class="at">s.st =</span> s.st4d, </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">site =</span> site, <span class="at">hab_mask =</span> hab_mask)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># store rescaled extent and convert to matrix</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>ext <span class="ot">=</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(rescale_list<span class="sc">$</span>ext, as.vector))</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare constants (note get density in activity center/100 m2)</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>constants <span class="ot">=</span> <span class="fu">list</span>(<span class="at">M =</span> M,<span class="at">n0 =</span>  <span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">apply</span>(data4d<span class="sc">$</span>y,<span class="dv">1</span>,sum)<span class="sc">!=</span><span class="dv">0</span>)),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">J=</span><span class="fu">dim</span>(data4d<span class="sc">$</span>y)[<span class="dv">2</span>], <span class="at">K=</span><span class="fu">dim</span>(data4d<span class="sc">$</span>y)[<span class="dv">3</span>], <span class="at">sigma_upper =</span> <span class="dv">1000</span>, </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">A =</span> (<span class="fu">sum</span>(hab_mask)<span class="sc">*</span>(pixelWidth<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">pixelWidth=</span>pixelWidth,<span class="at">nSites=</span><span class="fu">dim</span>(Xarray)[<span class="dv">3</span>],<span class="at">site =</span> site)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">X =</span> rescale_list<span class="sc">$</span>X,<span class="at">sex =</span> <span class="fu">c</span>(data4d<span class="sc">$</span>sex,<span class="fu">rep</span>(<span class="cn">NA</span>,M<span class="sc">-</span><span class="fu">length</span>(data4d<span class="sc">$</span>sex))),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="at">x_lower =</span> ext[,<span class="dv">1</span>],<span class="at">x_upper =</span> ext[,<span class="dv">2</span>],<span class="at">y_lower =</span> ext[,<span class="dv">3</span>],<span class="at">y_upper =</span> ext[,<span class="dv">4</span>])</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># store and format encounter history data</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">=</span> data4d<span class="sc">$</span>y[<span class="fu">which</span>(<span class="fu">apply</span>(data4d<span class="sc">$</span>y, <span class="dv">1</span>, sum)<span class="sc">!=</span><span class="dv">0</span>),,] <span class="co"># remove augmented records</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># covert to 2d by summing over individuals and traps</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">=</span> <span class="fu">apply</span>(data<span class="sc">$</span>y, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), sum) </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># add z and zeros vector data for latent inclusion indicator</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>z <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>n0),<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>M <span class="sc">-</span> constants<span class="sc">$</span>n0))</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>zeros <span class="ot">=</span>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>n0),<span class="fu">rep</span>(<span class="dv">0</span>,constants<span class="sc">$</span>M <span class="sc">-</span> constants<span class="sc">$</span>n0))</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co"># add hab_mask, proportion of available habitat, and OK for habitat check</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>hab_mask <span class="ot">=</span> hab_mask</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co"># need to adjust proportion of habitat available</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>prop.habitat<span class="ot">=</span><span class="fu">apply</span>(hab_mask,<span class="dv">3</span>,mean) </span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>OK <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,constants<span class="sc">$</span>M)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co"># get initial activity center starting values</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>s.st <span class="ot">=</span> rescale_list<span class="sc">$</span>s.st</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co"># define all initial values</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sigma =</span> <span class="fu">runif</span>(<span class="dv">2</span>, <span class="dv">250</span>, <span class="dv">350</span>), <span class="at">s =</span> s.st,<span class="at">psi=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>),</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="at">p0 =</span> <span class="fu">runif</span>(<span class="fu">dim</span>(data<span class="sc">$</span>X)[<span class="dv">3</span>], <span class="fl">0.1</span>, <span class="fl">0.2</span>),<span class="at">sex=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(data<span class="sc">$</span>sex),</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(constants<span class="sc">$</span>M<span class="sc">-</span>constants<span class="sc">$</span>n0,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="cn">NA</span>),</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="at">pOK=</span>data<span class="sc">$</span>OK,<span class="at">z=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,constants<span class="sc">$</span>n0),<span class="fu">rep</span>(<span class="dv">0</span>,constants<span class="sc">$</span>M<span class="sc">-</span>constants<span class="sc">$</span>n0)),</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="at">psi_sex=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>))</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;psi&quot;</span>,<span class="st">&quot;p0&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;psi_sex&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;z&quot;</span>)</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="co"># get model</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>scr_model <span class="ot">=</span> <span class="fu">get_classic</span>(<span class="at">dim_y =</span> <span class="dv">2</span>, <span class="at">enc_dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">sex_sigma =</span> <span class="cn">TRUE</span>,<span class="at">hab_mask=</span><span class="cn">TRUE</span>,<span class="at">trapsClustered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>() <span class="co"># track time elapsed</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">run_classic</span>(<span class="at">model =</span> scr_model, <span class="at">data=</span>data, <span class="at">constants=</span>constants,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="at">inits=</span>inits, <span class="at">params =</span> params,<span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin=</span><span class="dv">1000</span>, <span class="at">thin=</span><span class="dv">1</span>, <span class="at">nchains=</span><span class="dv">2</span>, </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="at">parallel=</span><span class="cn">TRUE</span>, <span class="at">RNGseed =</span> <span class="dv">500</span>)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 110.978 sec elapsed</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="co"># summary table of MCMC output (exclude &quot;s&quot; and &quot;z&quot; parameters)</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="fu">nimSummary</span>(out, <span class="at">exclude_params =</span> <span class="fu">c</span>(<span class="st">&quot;s&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="at">trace =</span> <span class="cn">TRUE</span>, <span class="at">plot_all =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          post.mean post.sd    q2.5     q50   q97.5 f0   n.eff  Rhat</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D            0.100   0.015   0.074   0.098   0.136  1 221.187 1.063</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N          223.906  34.525 166.000 221.000 306.000  1 221.187 1.063</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p0[1]        0.112   0.027   0.066   0.109   0.173  1 531.737 1.005</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p0[2]        0.108   0.024   0.069   0.106   0.162  1 534.815 1.006</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi          0.569   0.090   0.409   0.562   0.776  1 229.467 1.062</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; psi_sex      0.553   0.079   0.394   0.553   0.703  1 304.397 1.021</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[1]   252.076  37.377 192.030 247.679 335.659  1 264.634 1.009</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma[2]   330.496  35.807 270.581 326.672 411.406  1 268.864 1.015</span></span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:70%" />
</p>
<br>
<p>
<p>These trace plots show a bit of autocorrelation and we might run a
few more iterations to have everything nicely converged. However, we
note that only about 2 minutes is needed for the MCMC sampling to finish
even on our Windows 64-bit machine with only 8 GB of RAM.</p>
We again make a realized density surface and note that the
<code>realized_density()</code> function outputs a list of length 2 in
this example since we have 2 spatially separated trapping grids here
that are in a 3-dimensional array format.
</p>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate realized density surface</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">realized_density</span>(<span class="at">samples=</span>out, <span class="at">grid=</span>GridX<span class="sc">$</span>grid, <span class="at">crs_=</span>mycrs,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">site=</span>constants<span class="sc">$</span>site, <span class="at">hab_mask=</span>hab_mask)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load needed packages for multiplot</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis) </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rasterVis)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raster from site 1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">gplot</span>(r[[<span class="dv">1</span>]]) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_viridis</span>(<span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">name=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>           <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raster from site 2</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">gplot</span>(r[[<span class="dv">2</span>]]) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_viridis</span>(<span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">name=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange the two plots in a single row</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>prow <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>           p2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&#39;vh&#39;</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">nrow =</span> <span class="dv">1</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the legend from one of the plots</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>legend_t <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)))</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># add the legend above the row we made earlier. Give it 20% of the height</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co"># of one plot (via rel_heights).</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>pcomb <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(legend_t, prow, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(.<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co"># add x and y axis labels</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>pcomb <span class="ot">&lt;-</span><span class="fu">annotate_figure</span>(pcomb, <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Easting&quot;</span>, </span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Northing&quot;</span>, <span class="at">rot=</span><span class="dv">90</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>),</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>pcomb</span></code></pre></div>
<p align="center">
<img src="data:image/png;base64,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" style="width:90%" />
</p>
<br>
<p>
That’s it! You’ve made it through the first ‘localSCR’ tutorial. Please
see Royle et al. (2014) for more details about SCR theory and modeling.
The next tutorial will be similar but focused on spatial count models
that make inference to abundance/density for unmarked populations.
</p>
<p><br></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Chandler, R. B. 2018. Speeding up data augmentation in BUGS. <a href="https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE" class="uri">https://groups.google.com/forum/#!topic/hmecology/o6cWDqHHgOE</a>.</p>
<p>de Valpine P, C. Paciorek, D. Turek, N. Michaud, C. Anderson-Bergman,
F. Obermeyer, C. C. Wehrhahn, A. Rodrìguez, L. D. Temple, and S.
Paganin. 2022. <em>NIMBLE: MCMC, Particle Filtering, and Programmable
Hierarchical Modeling</em>. doi: 10.5281/zenodo.1211190 (URL: <a href="https://doi.org/10.5281/zenodo.1211190" class="uri">https://doi.org/10.5281/zenodo.1211190</a>), R package
version 0.12.2, URL: <a href="https://cran.r-project.org/package=nimble" class="uri">https://cran.r-project.org/package=nimble</a>.</p>
<p>Furnas, B. J., R. H. Landers, S. Hill, S. S. Itoga, and B. N. Sacks.
2018. Integrated modeling to estimate population size and composition of
mule deer. Journal of Wildlife Management 82:1429–1441.</p>
<p>Milleret, C., P. Dupont, C. Bonenfant, H. Henrik Brøseth, Ø.
Flagstad, C. Sutherland, and R. Bischof. 2019. A local evaluation of the
individual state‐space to scale up Bayesian spatial capture‐recapture.
Ecology and Evolution 9:352–363.</p>
<p>Turek, D., C. Milleret, T. Ergon, and H. Brøseth 2021. Efficient
estimation of large‐scale spatial capture–recapture model. Ecosphere <a href="DOI:10.1002/ecs2.338" class="uri">DOI:10.1002/ecs2.338</a>5.</p>
<p>Royle, J. A., R. B. Chandler, R. Sollmann, and B. Gardner. 2014.
Spatial capture‐recapture. Academic Press, Waltham, Massachusetts,
USA.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
